{"config":{"lang":["it"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Cohesion id","text":""},{"location":"#che-cose","title":"Che cos'\u00e8?","text":"<p>CohesionID \u00e8 il framework di autenticazione della Regione Marche che permette di verificare la corretta identit\u00e0 degli utenti (Persone fisiche munite di codice fiscale) che accedono a servizi digitali della Regione o degli Enti convenzionati. </p> <p>Cohesion gestisce il processo di autenticazione mentre demanda al sistema integrante il processo di autorizzazione/profilatura utente all\u2019applicazione chiamante. Cohesion supporta diversi livelli di autenticazione sicura: basso, significativo ed elevato. </p>"},{"location":"#con-quali-modalita-e-possibile-accedere-con-cohesion","title":"Con quali modalit\u00e0 \u00e8 possibile accedere con Cohesion?","text":"<p>Cohesion supporta tutti i principali sistemi di autenticazione e di identificazione digitale verso i sistemi della PA, previsti dal Codice dell\u2019Amministrazione Digitale (decreto legislativo 7 marzo 2005, n. 82). I cittadini possono accedere tramite le loro credenziali SPID, con la loro Carta di Identit\u00e0 Elettronica (CIE-ID), Tramite CNS e tramite il nodo italiano eIDAS. Ulteriori informazioni circa le due modalit\u00e0 di accesso principali sono reperibili all\u2019indirizzo: Cohesion</p>"},{"location":"#accedere-con-spid","title":"Accedere con SPID","text":"<p>Il Sistema Pubblico di Identit\u00e0 Digitale (SPID) \u00e8 un\u2019identit\u00e0 digitale composta da una coppia di credenziali (username e password), strettamente personali, con le quali \u00e8 possibile accedere ai servizi online della pubblica amministrazione e dei privati aderenti.  Per ottenere le tue credenziali SPID puoi rivolgerti a uno dei gestori di identit\u00e0 (detti identity provider) accreditati dall\u2019Agenzia per l\u2019Italia Digitale (AgID). Al momento i gestori d\u2019identit\u00e0 sono 12: Aruba PEC SpA, Etna Hitech SCpA, InfoCamere SCpA, InfoCert SpA, Intesi Group SpA, Lepida ScpA, Namirial SpA, Poste Italiane SpA, Register SpA, Sielte SpA, TeamSystem SpA e TI Trust Technologies Srl.  Ogni gestore offre diverse modalit\u00e0 per richiedere e ottenere SPID: scegli quella pi\u00f9 adatta alle tue esigenze. Per tutte le informazioni su dove e come chiedere le tue credenziali SPID vai alla pagina Come attivare SPID.</p>"},{"location":"#accedere-con-cie","title":"Accedere con CIE","text":"<p>La Carta di Identit\u00e0 Elettronica (CIE) \u00e8 la chiave di accesso, garantita dallo Stato e rilasciata dal Ministero dell\u2019Interno, che permette al cittadino di autenticarsi in tutta sicurezza ai servizi online di enti e pubbliche amministrazioni che ne consentono l\u2019utilizzo.</p> <p>Grazie alla CIE i cittadini non devono pi\u00f9 utilizzare credenziali diverse per ogni Amministrazione, ma hanno a disposizione un unico strumento di identificazione fisica e digitale per accedere ai servizi in rete, pubblici e privati, in Italia e in Europa.</p> <p>Infatti, con la realizzazione del nodo eIDAS italiano si completa il progetto di cittadinanza digitale europea, che permette ai titolari di una CIE di accedere anche ai servizi online di altri Paesi dell\u2019Unione Europea (ad esempio servizi universitari, bancari o delle pubbliche amministrazioni). Per informazioni sul come ottenere ed attivare la tua CIE, consulta la pagina CIE: La Carta di Identit\u00e0 Digitale</p>"},{"location":"#accedere-con-cns","title":"Accedere con CNS","text":"<p>La Carta Nazionale dei Servizi (CNS) \u00e8 uno strumento di identificazione in rete che consente la fruizione dei servizi delle amministrazioni pubbliche. La CNS non contiene la foto del titolare e non richiede particolari requisiti di sicurezza per il supporto plastico. La completa corrispondenza informatica tra CNS e Carta d'Identit\u00e0 Elettronica (CIE) assicura l\u2019interoperabilit\u00e0 tra le due carte. Per maggiori informazioni circa le modalit\u00e0 di accesso con CNS \u00e8 possibile consultare il sito CNS: Carta Nazionale dei Servizi</p>"},{"location":"Ambiente%20di%20collaudo/","title":"Ambiente di collaudo","text":"<p>A supporto di enti e fornitori nel processo di integrazione con il sistema CohesionID, \u00e8 stato predisposto un ambiente di collaudo che consente di verificare il corretto funzionamento delle configurazioni implementate.</p>"},{"location":"Ambiente%20di%20collaudo/#requisiti-per-laccesso","title":"Requisiti per l'accesso","text":"<p>L'accesso all'ambiente di collaudo \u00e8 riservato a enti o fornitori che:</p> <ul> <li>hanno completato la procedura di integrazione con CohesionID;</li> <li>hanno ricevuto l'ID Sito univoco assegnato dal team tecnico Cohesion.</li> </ul> <p>L\u2019ambiente di collaudo sar\u00e0 disponibile dal giorno solare successivo all\u2019avvenuta federazione del sistema. Per maggiori informazioni in merito alla richiesta di integrazione e all'ottenimento dell'ID Sito, \u00e8 possibile fare riferimento all'apposita sezione: Richiesta integrazione</p>"},{"location":"Ambiente%20di%20collaudo/#configurazione-dellambiente-di-collaudo","title":"Configurazione dell'ambiente di collaudo","text":"<p>Per effettuare una richiesta di autenticazione in ambiente di collaudo, \u00e8 necessario inviare una chiamata in GET all'indirizzo:</p> <p>https://cohesioncollaudo.regione.marche.it/SPManager/WAYF.aspx</p> <p>La richiesta deve includere il parametro <code>AUTH</code>, contenente i parametri necessari alla gestione dell'autenticazione. Per dettagli sulla struttura del parametro e sulla configurazione della richiesta, \u00e8 possibile fare riferimento alla sezione: Flusso di autenticazione</p>"},{"location":"Ambiente%20di%20collaudo/#credenziali-di-test","title":"Credenziali di test","text":"<p>In ambiente di collaudo non \u00e8 possibile effettuare autenticazioni tramite SPID, CIE o altri sistemi di identit\u00e0 digitale.</p> <p>Per finalit\u00e0 di verifica vengono messe a disposizione due utenze fittizie CohesionID:</p> <p>Utente 1 - Codice Fiscale: TSTTNT80A01H501O - Password/PIN: 13579113</p> <p>Utente 2 - Codice Fiscale: TSTTNT80A41H501S - Password/PIN: 24681012</p> <p>ATTENZIONE Le credenziali di test sono valide esclusivamente nell'ambiente di collaudo e non abilitano l'accesso ai servizi in produzione.</p>"},{"location":"Documentazione-tecnica/","title":"Integrazione .NET Core 8","text":""},{"location":"Documentazione-tecnica/#integrazione-classe-c","title":"Integrazione Classe C#","text":""},{"location":"Documentazione-tecnica/#integrazione-classe-c-core","title":"Integrazione Classe C# Core","text":""},{"location":"Documentazione-tecnica/#integrazione-servlet-java","title":"Integrazione Servlet Java","text":""},{"location":"Documentazione-tecnica/#integrazione-php","title":"Integrazione PHP","text":""},{"location":"Documentazione-tecnica/#integrazione-phyton-beta","title":"Integrazione Phyton (beta)","text":""},{"location":"FAQ/","title":"FAQ \u2013 Domande frequenti","text":""},{"location":"FAQ/#informazioni-generali","title":"\ud83e\udded Informazioni generali","text":""},{"location":"FAQ/#che-cose-cohesion-id","title":"Che cos'\u00e8 Cohesion ID?","text":"<p>Cohesion ID \u00e8 un framework di autenticazione progettato per verificare l'identit\u00e0 degli utenti (persone fisiche con codice fiscale) che accedono ai servizi digitali della Regione Marche o degli Enti convenzionati.</p>"},{"location":"FAQ/#quali-sono-i-livelli-di-autenticazione-supportati-da-cohesion","title":"Quali sono i livelli di autenticazione supportati da Cohesion?","text":"<p>Cohesion supporta tre livelli di autenticazione: basso, significativo ed elevato, offrendo opzioni di sicurezza adatte a diverse esigenze.</p>"},{"location":"FAQ/#quali-sono-i-sistemi-di-autenticazione-supportati-da-cohesion","title":"Quali sono i sistemi di autenticazione supportati da Cohesion?","text":"<p>Cohesion supporta i principali sistemi di autenticazione e identificazione digitale previsti dal Codice dell'Amministrazione Digitale, tra cui SPID, Carta di Identit\u00e0 Elettronica (CIE-ID), CNS e nodo italiano eIDAS.</p>"},{"location":"FAQ/#gestione-credenziali","title":"\ud83e\uddfe Gestione credenziali","text":""},{"location":"FAQ/#come-posso-ottenere-credenziali-di-accesso-cohesion-id","title":"Come posso ottenere credenziali di accesso Cohesion id?","text":"<p>Attenzione</p> <p>A partire dal 1\u00b0 marzo 2021, ai sensi dell\u2019art. 24 del D.L. 76/2020, convertito con modificazioni dalla L. 120/2020 (Decreto Semplificazioni), le credenziali Cohesion id possono essere rilasciate esclusivamente al personale interno della Pubblica Amministrazione.</p> <p>I cittadini non possono pi\u00f9 ottenere nuove credenziali Cohesion ID, ma possono accedere ai servizi digitali tramite:</p> <ul> <li>SPID (Sistema Pubblico di Identit\u00e0 Digitale)  </li> <li>CIE (CieID) \u2013 Carta d\u2019Identit\u00e0 Elettronica  </li> <li>CNS \u2013 Carta Nazionale dei Servizi  </li> </ul> <p>Le credenziali Cohesion id possono essere rilasciate esclusivamente ai dipendenti della Pubblica Amministrazione o a soggetti autorizzati all\u2019interno di enti convenzionati, nei casi previsti dalla normativa vigente.</p> <p>Per effettuare la richiesta, \u00e8 possibile rivolgersi a:</p> <ul> <li> <p>Servizio Cittadinanza Digitale \u2013 Regione Marche   \ud83d\udce7 cittadinanza.digitale@regione.marche.it</p> </li> <li> <p>Ufficio di registrazione del proprio ente di appartenenza (l\u2019elenco degli uffici abilitati \u00e8 attualmente in fase di aggiornamento)</p> </li> </ul>"},{"location":"FAQ/#ho-dimenticato-la-password-come-posso-recuperarla","title":"Ho dimenticato la password, come posso recuperarla?","text":"<p>In caso di smarrimento della password, \u00e8 possibile avviare la procedura di recupero online: \ud83d\udc49 Recupera la password</p> <p>In alternativa, \u00e8 possibile cliccare su My Cohesion, il menu disponibile in alto a destra in ogni pagina di login Cohesion id, e selezionare la voce Reset Password per avviare la procedura.</p>"},{"location":"FAQ/#come-posso-cambiare-la-mia-password","title":"Come posso cambiare la mia password?","text":"<p>Per modificare la propria password, accedere al menu My Cohesion presente in alto a destra in ogni pagina di login e selezionare la voce Cambia Password.</p> <p>Per procedere sar\u00e0 necessario effettuare l\u2019autenticazione.</p>"},{"location":"FAQ/#ho-dimenticato-il-pin-come-posso-recuperarlo","title":"Ho dimenticato il PIN, come posso recuperarlo?","text":"<p>Il recupero del PIN pu\u00f2 essere richiesto:</p> <ul> <li>Telefonando all\u2019Helpdesk: 071 8063000, interno 1</li> <li>Inviando una mail a: cittadinanza.digitale@regione.marche.it </li> <li>Presso un ufficio di registrazione abilitato</li> </ul>"},{"location":"FAQ/#come-posso-aggiungere-il-pin-alla-mia-utenza-esistente-codice-fiscale-password","title":"Come posso aggiungere il PIN alla mia utenza esistente (Codice Fiscale + Password)?","text":"<p>Gli utenti in possesso delle sole credenziali Codice Fiscale + Password possono richiedere l\u2019aggiunta del PIN, necessario per accedere ai servizi che richiedono un livello di autenticazione significativo, purch\u00e9 rientrino nei casi previsti dalla normativa vigente (vedi riquadro \u201cAttenzione\u201d all\u2019inizio della pagina).</p> <p>La richiesta pu\u00f2 essere effettuata attraverso uno dei seguenti canali:</p> <ul> <li> <p>Contattando l\u2019Helpdesk: \u260e\ufe0f 071 8063000, interno 1</p> </li> <li> <p>Scrivendo a: \ud83d\udce7 cittadinanza.digitale@regione.marche.it</p> </li> <li>Rivolgendosi a un ufficio di registrazione abilitato (lista in aggiornamento)</li> </ul>"},{"location":"FAQ/#integrazione-e-configurazione","title":"\u2699\ufe0f Integrazione e configurazione","text":""},{"location":"FAQ/#come-posso-ottenere-il-mio-id-sito","title":"Come posso ottenere il mio ID Sito?","text":"<p>Se il sistema informativo che vuoi integrare \u00e8 pubblicato da o per conto di Regione Marche, \u00e8 possibile compilare direttamente la richiesta di integrazione al seguente link: \ud83d\udd17 https://procedimenti.regione.marche.it/Pratiche/Avvia/3049</p> <p>Effettuata la richiesta, i nostri tecnici forniranno il vostro codice ID Sito univoco.</p> <p>Nel caso in cui l'ente responsabile sia differente, \u00e8 necessario assicurarsi che questi abbia sottoscritto la convenzione per l'utilizzo dell'Infrastruttura di autenticazione e accesso della Regione Marche in qualit\u00e0 di soggetto aggregatore SPID: \ud83d\udd17 https://procedimenti.regione.marche.it/AreaPA/TipologieProcedimento/DettagliTer/13915</p>"},{"location":"FAQ/#ho-bisogno-di-assistenza-per-lintegrazione-di-cohesion-nel-mio-applicativo-chi-posso-contattare","title":"Ho bisogno di assistenza per l'integrazione di Cohesion nel mio applicativo, chi posso contattare?","text":"<p>Se hai bisogno di aiuto in merito all'integrazione di Cohesion, contattaci all'indirizzo Integrazione Cohesion</p>"},{"location":"FAQ/#livelli-di-autenticazione","title":"\ud83d\udd10 Livelli di autenticazione","text":""},{"location":"FAQ/#un-sito-della-pubblica-amministrazione-esposto-solo-su-rete-interna-e-utilizzato-esclusivamente-da-dipendenti-puo-adottare-un-livello-di-autenticazione-basso","title":"Un sito della Pubblica Amministrazione, esposto solo su rete interna e utilizzato esclusivamente da dipendenti, pu\u00f2 adottare un livello di autenticazione \"basso\"?","text":"<p>No, in linea generale un sito della Pubblica Amministrazione, anche se accessibile solo da rete interna e riservato ai soli dipendenti, non pu\u00f2 adottare un livello di autenticazione \"basso\" se sussiste almeno una delle seguenti condizioni:</p> <ul> <li>tratta dati personali o informazioni riservate;</li> <li>consente la gestione o visualizzazione di contenuti amministrativi, come atti, determinazioni, provvedimenti o documenti protocollati;</li> <li>abilita operazioni rilevanti dal punto di vista amministrativo o organizzativo.</li> </ul> <p>L\u2019adozione di un livello di autenticazione basso \u00e8 ammessa solo se sussistono contemporaneamente tutte le seguenti condizioni:</p> <ul> <li>Il sito non tratta dati personali, n\u00e9 atti amministrativi o documenti protocollati;</li> <li>Le funzionalit\u00e0 offerte hanno un basso impatto sul rischio di sicurezza, limitandosi ad attivit\u00e0 informative o consultive non critiche;</li> <li>L\u2019accesso \u00e8 protetto a livello infrastrutturale, ad esempio tramite rete isolata, VPN o autenticazione a dominio;</li> <li>\u00c8 garantito il rispetto dei principi di proporzionalit\u00e0, minimizzazione e necessit\u00e0, ai sensi del Regolamento (UE) 2016/679 \u2013 GDPR.</li> </ul> <p>In assenza di queste condizioni, il livello minimo di autenticazione richiesto deve essere almeno \"significativo\", come previsto dalla normativa.</p>"},{"location":"FAQ/#gli-utenti-del-servizio-pa-hanno-sempre-utilizzato-nome-utente-e-password-di-cohesion-livello-basso-per-accedereinnalzando-il-livello-a-significativo-codice-fiscale-password-e-pin-molti-di-loro-non-riusciranno-piu-ad-accedere-come-e-possibile-fare","title":"Gli utenti del servizio PA hanno sempre utilizzato nome utente e password di Cohesion (livello \"basso\") per accedere.Innalzando il livello a \"significativo\" (Codice Fiscale, Password e PIN), molti di loro non riusciranno pi\u00f9 ad accedere. Come \u00e8 possibile fare?","text":"<p>Con l\u2019innalzamento del livello di autenticazione da \"basso\" a \"significativo\", l\u2019accesso al servizio richiede un meccanismo di autenticazione pi\u00f9 robusto, conforme al Regolamento eIDAS e alle Linee guida AgID sull\u2019identit\u00e0 digitale.</p> <p>Per garantire la continuit\u00e0 del servizio:</p> <ul> <li>Gli utenti esterni alla Pubblica Amministrazione (es. cittadini, imprese, professionisti) dovranno utilizzare un\u2019identit\u00e0 digitale qualificata, scegliendo tra:</li> <li>SPID (Sistema Pubblico di Identit\u00e0 Digitale)  </li> <li>CIE (Carta d\u2019Identit\u00e0 Elettronica)</li> <li>CNS (Carta Nazionale dei Servizi)</li> </ul> <p>Questi strumenti garantiscono un livello di autenticazione \"significativo\" o \"elevato\", pienamente compatibile con il nuovo requisito del servizio.</p> <ul> <li>Per gli utenti interni alla PA (dipendenti), in alternativa a SPID/CIE/CNS, \u00e8 possibile rilasciare un PIN Cohesion, che consente l\u2019accesso al sistema in modalit\u00e0 \"significativa\" attraverso il circuito di autenticazione federato Cohesion, integrando:</li> <li>Codice Fiscale</li> <li>Password</li> <li>PIN personale</li> </ul> <p>In questo modo si garantisce il rispetto dei requisiti normativi senza compromettere l\u2019accessibilit\u00e0 al servizio da parte degli utenti autorizzati.</p>"},{"location":"FAQ/#ce-un-livello-minimo-di-autenticazione","title":"C\u2019\u00e8 un livello minimo di autenticazione?","text":"<p>S\u00ec, secondo le normative in vigore, il livello minimo di autenticazione richiesto \u00e8 \"significativo\" (livello 2).</p> <p>Tuttavia, se il servizio non richiede una protezione elevata e soddisfa determinati requisiti (ad esempio, non trattando dati sensibili o riservati), pu\u00f2 essere richiesto un livello di autenticazione inferiore. In tal caso, \u00e8 necessario giustificare questa scelta in fase di integrazione o, successivamente, attraverso una richiesta formale di modifica del livello di autenticazione.</p>"},{"location":"FAQ/#un-sito-che-gestisco-e-gia-integrato-in-cohesion-che-di-default-applica-il-livello-significativo-di-autenticazione-tuttavia-il-mio-sito-ha-caratteristiche-che-giustificherebbero-un-accesso-con-livello-basso-a-chi-posso-comunicarlo","title":"Un sito che gestisco \u00e8 gi\u00e0 integrato in Cohesion, che di default applica il livello \"significativo\" di autenticazione. Tuttavia, il mio sito ha caratteristiche che giustificherebbero un accesso con livello \"basso\". A chi posso comunicarlo?","text":"<p>Nel sistema Cohesion, il livello di autenticazione \"significativo\" viene applicato come impostazione predefinita per garantire il rispetto delle Linee guida AgID. Tuttavia, se il sito non tratta dati personali, atti amministrativi o contenuti sensibili e soddisfa i requisiti per un livello di autenticazione \"basso\", \u00e8 possibile richiedere l\u2019adeguamento.</p> <p>La comunicazione del livello minimo di autenticazione avviene in due modalit\u00e0:</p> <ul> <li> <p>In fase di federazione iniziale:   \u00c8 necessario compilare il modulo di richiesta federazione, specificando il livello minimo desiderato (il livello basso deve essere opportunamente giustificato), disponibile al seguente link:   \ud83d\udd17 Modulo federazione Cohesion \u2013 Avvio</p> </li> <li> <p>In caso di variazione successiva (es. abbassamento del livello da \"significativo\" a \"basso\"):   Occorre compilare il modulo di richiesta di modifica del livello di autenticazione, disponibile qui:   \ud83d\udd17 Modulo richiesta modifica livello di accesso</p> </li> </ul> <p>La richiesta sar\u00e0 valutata dal team tecnico e, se conforme ai criteri di sicurezza e proporzionalit\u00e0 previsti dalla normativa vigente, il livello potr\u00e0 essere aggiornato di conseguenza nel sistema Cohesion.</p>"},{"location":"Flusso-di-Autenticazione/","title":"Flusso di Autenticazione","text":""},{"location":"Flusso-di-Autenticazione/#1-lutente-richiede-di-effettuare-il-login","title":"1. L'utente richiede di effettuare il login","text":"<p>L'utente desidera effettuare l'accesso ad un'applicazione che integra il sistema Cohesion, cliccando sul login viene reindirizzato al sistema Cohesion ID.</p>"},{"location":"Flusso-di-Autenticazione/#2-lutente-sceglie-lidp","title":"2. L'utente sceglie l'IdP","text":"<p>L'utente seleziona l'Identity Provider per effettuare la procedura di riconoscimento.  Cohesion genera una richiesta di accesso in cui ottiene il Codice Fiscale e l'ID Sessione dell'utente.</p>"},{"location":"Flusso-di-Autenticazione/#3-accesso-allapplicativo","title":"3. Accesso all'applicativo","text":"<p>Cohesion effettua una seconda chiamata al fine ottenere gli attributi dell'utente recuperati dall'Identity Provider scelto dall'utente.</p> <p>L'utente viene reindirizzato all'applicazione con un token proprietario, contente gli attributi necessari all'accesso.</p>"},{"location":"Flusso-di-Autenticazione/#auth-request","title":"Auth Request","text":"<p>Per accedere ai servizi offerti da CohesionID, \u00e8 necessario effettuare una chiamata in GET all'indirizzo https://cohesion2.regione.marche.it/SPManager/WAYF.aspx con un parametro <code>AUTH</code> contenente dei parametri di autenticazione come quelli dell'esempio in basso.</p> <p>Il chiamante, in questo esempio, sar\u00e0 example.cohesion.it:</p> <pre><code>&lt;?xml version=\"1.0\" ?&gt;\n&lt;dsAuth xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"http://tempuri.org/Auth.xsd\"&gt;\n    &lt;auth&gt;\n        &lt;user/&gt;\n        &lt;id_sa/&gt;\n        &lt;id_sito&gt;ID SITO ASSEGNATO&lt;/id_sito&gt;\n        &lt;esito_auth_sa/&gt;\n        &lt;id_sessione_sa/&gt;\n        &lt;id_sessione_aspnet_sa/&gt;\n        &lt;url_validate&gt;https://example.cohesion.it/cohesionAuthCallback&lt;/url_validate&gt;\n        &lt;url_richiesta&gt;https://example.cohesion.it:443/cohesionErrorCallback&lt;/url_richiesta&gt;\n        &lt;esito_auth_sso/&gt;\n        &lt;id_sessione_sso/&gt;\n        &lt;id_sessione_aspnet_sso/&gt;\n        &lt;stilesheet&gt;AuthRestriction=1,2,3&lt;/stilesheet&gt;\n    &lt;/auth&gt;\n&lt;/dsAuth&gt;\n</code></pre> <p>In particolare:</p> <ul> <li>id_sito: \u00e8 l'identificativo assegnato all'integrazione specifica con Cohesion. Ogni sito ha un id_sito differente e univoco</li> <li>url_validate: contiente l'URL al quale Cohesion reindirizza i dati ottenuti dall'Identity Provider utilizzato (Poste, Namirial, Cohesion, ecc...) dopo la login</li> <li>url_richieste: contiene l'URL della pagina a cui tornare in caso di errori di autenticazione</li> <li>stilesheet: contiente (opzionalmente) l'URL al quale Cohesion fa il redirect dopo aver eseguito la cancellazione della sessione in seguito ad una richiesta di logout. Contiene anche eventuali restrizioni sul livello di autenticazione richiesto (SPID livello 1, 2 o 3). Per specificare il livello di autenticazione \u00e8 sufficiente inserire il parametro <code>&lt;AuthRestriction=1,2,3&gt;</code> indicando il numero del livello minimo accettabile (per accettare ogni tipo di autenticazione, impostare il parametro con 0,1,2,3)</li> </ul> <p>Esempio:</p> <pre><code>&lt;?xml version=\"1.0\" ?&gt;\n&lt;dsAuth xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"http://tempuri.org/Auth.xsd\"&gt;\n    &lt;auth&gt;\n        &lt;user/&gt;\n        &lt;id_sa/&gt;\n        &lt;id_sito&gt;COHESION_EXAMPLE&lt;/id_sito&gt;\n        &lt;esito_auth_sa/&gt;\n        &lt;id_sessione_sa/&gt;\n        &lt;id_sessione_aspnet_sa/&gt;\n        &lt;url_validate&gt;https://example.cohesion.it/Login&lt;/url_validate&gt;\n        &lt;url_richiesta&gt;https://example.cohesion.it&lt;/url_richiesta&gt;\n        &lt;esito_auth_sso/&gt;\n        &lt;id_sessione_sso/&gt;\n        &lt;id_sessione_aspnet_sso/&gt;\n        &lt;stilesheet&gt;AuthRestriction=2,3;https://example.cohesion.it/LogOff&lt;/stilesheet&gt;\n    &lt;/auth&gt;\n&lt;/dsAuth&gt;\n</code></pre> <p>In questo esempio, diciamo a Cohesion che:</p> <ul> <li>vogliamo che il token di autenticazione venga inoltrato in POST (per default) all'indirizzo https://example.cohesion.it/Login</li> <li>vogliamo che, una volta fatto il logout, Cohesion reindirizzi all'URL https://example.cohesion.it/LogOff</li> <li>il livello di autenticazione minimo accettabile \u00e8 il 2 (Codice fiscale + password + PIN se l'IdP \u00e8 Cohesion oppure SPID livello 2 negli altri casi).</li> <li>se ci sono errori, vogliamo che Cohesion torni alla homepage https://example.cohesion.it</li> </ul> <p>L'XML contenuto nel parametro auth deve essere codificato in base64 e poi con URL Encode. Un esempio di prodotto finale ha questa forma:</p> <pre><code>PD94bWwgdmVyc2lvbj0iMS4wIiA%2FPg0KPGRzQXV0aCB4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlIi\nB4bWxucz0iaHR0cDovL3RlbXB1cmkub3JnL0F1dGgueHNkIj4NCgk8YXV0aD4NCgkJPHVzZXIvPg0KCQk8aWRfc2EvPg0KCQk8aWRfc2l0bz5leGFtcGxl\nPC9pZF9zaXRvPg0KCQk8ZXNpdG9fYXV0aF9zYS8+DQoJCTxpZF9zZXNzaW9uZV9zYS8+DQoJCTxpZF9zZXNzaW9uZV9hc3BuZXRfc2EvPg0KCQk8dXJsX3Z\nhbGlkYXRlPmh0dHBzOi8vZXhhbXBsZS5jb2hlc2lvbi5pdC9Mb2dpbjwvdXJsX3ZhbGlkYXRlPg0KCQk8dXJsX3JpY2hpZXN0YT5odHRwczovL2V4YW1wb\nGUuY29oZXNpb24uaXQ8L3VybF9yaWNoaWVzdGE+DQoJCTxlc2l0b19hdXRoX3Nzby8+DQoJCTxpZF9zZXNzaW9uZV9zc28vPg0KCQk8aWRfc2Vzc2lvbm\nVfYXNwbmV0X3Nzby8+DQoJCTxzdGlsZXNoZWV0PkF1dGhSZXN0cmljdGlvbj0yLDM7aHR0cHM6Ly9leGFtcGxlLmNvaGVzaW9uLml0L0xvZ09mZjwvc3Rpb\nGVzaGVldD4NCgk8L2F1dGg+DQo8L2RzQXV0aD4\n</code></pre>"},{"location":"Flusso-di-Autenticazione/#cosa-contiene-il-token-cohesion-dopo-lautenticazione","title":"Cosa contiene il token Cohesion dopo l'autenticazione?","text":"<p>Dopo l'autenticazione dell'utente, Cohesion effettua una chiamata POST all'indirizzo specificato in url_validate nel cui body verr\u00e0 specificato un token di autenticazione.  Nel body ci sar\u00e0 un elemento auth codificato in base64 e URL Encoded che conterr\u00e0 un XML di questo tipo:</p> <pre><code>&lt;?xml version=\"1.0\" ?&gt;\n&lt;dsAuth xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"http://tempuri.org/Auth.xsd\"&gt;\n    &lt;auth&gt;\n        &lt;user&gt;RSSMRA85D18F051Y&lt;/user&gt;\n        &lt;id_sa/&gt;\n        &lt;id_sito&gt;example&lt;/id_sito&gt;\n        &lt;esito_auth_sa/&gt;\n        &lt;id_sessione_sa/&gt;\n        &lt;id_sessione_aspnet_sa/&gt;\n        &lt;url_validate&gt;https://example.cohesion.it/Login&lt;/url_validate&gt;\n        &lt;url_richiesta&gt;https://example.cohesion.it&lt;/url_richiesta&gt;\n        &lt;esito_auth_sso&gt;OK&lt;/esito_auth_sso&gt;\n        &lt;id_sessione_sso&gt;A5D64899EBCEE1FA6B3E8FB3D3D358D7E5843EA25EDFD62277CACE8A5EF23B1C5E6FAB916F333B0AFB0FAE6C4CDF7B8E8DEE461E8661DB04F5FFB01BC0EF9FCB90EEA2ACA7988119EFE17D5C3BB58BC890D75D724D434D7D60C2F451F6A51D1DFFA900EF0AAA631A51458860C6CEC7B1EBC525561624208066DF276314F41F6EC258CA3F&lt;/id_sessione_sso&gt;\n        &lt;id_sessione_aspnet_sso&gt;ufrq00x4f0cq2yog2ozv4lxx;https://idp.namirialtsp.com/idp;https://example.cohesion.it/LogOff;AAdzZWNyZXQxGLSQhZFb4TSPKKPNCGfO5MaCcJ99DiuEnIzpO4YvtOrgf+6qvwyEVOguFDCVbyPcZ2hhjbBtPtuCWUGs+FYX9zREfvZ1heshK7yzE24MU7JsIBK17atMdbL31QbDPNKbH2wiswXhL2CJGjY=;AAdzZWNyZXQxGLSQhZFb4TSPKKPNCGfO5MaCcJ99DiuEnIzpO4YvtOrgf+6qvwyEVOguFDCVbyPcZ2hhjbBtPtuCWUGs+FYX9zREfvZ1heshK7yzE24MU7JsIBK17atMdbL31QbDPNKbH2wiswXhL2CJGjY=;&lt;/id_sessione_aspnet_sso&gt;\n        &lt;stilesheet&gt;AuthRestriction=1,2,3;https://example.cohesion.it/LogOff&lt;/stilesheet&gt;\n        &lt;ip xmlns=\"\"&gt;cohesion2.regione.marche.it&lt;/ip&gt;\n        &lt;AuthRestriction xmlns=\"\"&gt;1,2,3&lt;/AuthRestriction&gt;\n        &lt;UType xmlns=\"\"&gt;CD&lt;/UType&gt;\n        &lt;purpose xmlns=\"\"/&gt;\n        &lt;url_logout xmlns=\"\"&gt;https://example.cohesion.it/LogOff&lt;/url_logout&gt;\n        &lt;cittad xmlns=\"\"&gt;1&lt;/cittad&gt;\n    &lt;/auth&gt;\n&lt;/dsAuth&gt;\n</code></pre> <p>Queste informazioni contengono solamente il codice fiscale dell'utente, ma non i suoi attributi.</p> <p>ATTENZIONE</p> <p>L'applicazione integrante \u00e8 tenuta a verificare il livello di accesso indicato nel token ricevuto al termine della procedura di login, al fine di garantire che sia conforme a quanto previsto dal livello di autenticazione configurato.</p> <p>Per ottenere gli attributi completi, \u00e8 necessario effettuare una chiamata GET o POST all'indirizzo https://cohesion2.regione.marche.it/SPManager/webCheckSessionSSO.aspx con i seguenti parametri:</p> <pre><code>Operation=GetCredential&amp;IdSessioneSSO={id_sessione_sso}&amp;IdSessioneASPNET={id_sessione_aspnet_sso}\n</code></pre> <p>Il token SAML restituito da Cohesion avr\u00e0 la forma seguente:</p> <pre><code>&lt;Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"&gt;\n    &lt;SignedInfo&gt;\n        &lt;CanonicalizationMethod Algorithm=\"http://www.w3.org/TR/2001/REC-xml-c14n-20010315\"/&gt;\n        &lt;SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\"/&gt;\n        &lt;Reference URI=\"#SignedXmlId\"&gt;\n            &lt;DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/&gt;\n            &lt;DigestValue&gt;rNHSy/TcTBIweMerIO3jizVm7u0=&lt;/DigestValue&gt;\n        &lt;/Reference&gt;\n    &lt;/SignedInfo&gt;\n    &lt;SignatureValue&gt;\n        Oz9wACp9Rxo4Z4pC8o61iXuVSJNO+UcszPNcAMNFUAY0I17IeGnB93JpwEWGbPfqn5a+i3IQdNsqlIbQtwAGovBQ6DTTb85kDo4YDue26o7a4np5DfwnO6SuhHsBHMbTvnI9A+45Q7Li4On+eELEQWFRrbS11MmwRYBxR5m5PWKupkX3O2r9JtG6tuKwi/L5+A4U/MqLKDdUm9/TX1lzn5c23XpQgiYpkGrwRqp+Q1Dsem7FcV868VYvgwYkRkj/jNgLFtcdoFij+qBRZi47EUa35KeZgP5V1ENcYigG0OXQQbdavCnPcE3EHjEL3ApkuPNVuSbJZv5TjgFdCpqjXg==\n    &lt;/SignatureValue&gt;\n    &lt;KeyInfo&gt;\n        &lt;X509Data&gt;\n            &lt;X509Certificate&gt;\n                MIIGtDCCBJygAwIBAgITLAAAAIIFAntkot9CUgAAAAAAgjANBgkqhkiG9w0BAQsFADBXMRUwEwYKCZImiZPyLGQBGRYFaW50cmExHTAbBgoJkiaJk/IsZAEZFg1yZWdpb25lbWFyY2hlMR8wHQYDVQQDExZSZWdpb25lIE1hcmNoZSBTdWJDQTAxMB4XDTE4MDIxOTA5MjgwM1oXDTIyMDIxODA5MjgwM1owgcIxCzAJBgNVBAYTAklUMQ4wDAYDVQQIEwVJdGFseTEPMA0GA1UEBxMGQW5jb25hMRcwFQYDVQQKEw5SZWdpb25lIE1hcmNoZTEtMCsGA1UECxMkUC5GLiBJbmZvcm1hdGljYSBlIENyZXNjaXRhIERpZ2l0YWxlMRcwFQYDVQQDEw5DbGllbnRDb2hlc2lvbjExMC8GCSqGSIb3DQEJARYiaGVscGRlc2tDb2hlc2lvbkByZWdpb25lLm1hcmNoZS5pdDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALbvK/Y/2uiFLqJoBmLHyKB7a3EnfqJJ+ySQEA9K1V+PEaRacctKmTDKRF5BHuIs1mCJDGcyz79kFyu+FyQL6LwL4PZ1PB+SsSVtnh+jCjO+4a/VYoC2t1/KJ7wlYQ0Wh22RVVfcqgaweyfaswBbdO+PyMPJ13LqMx6sC3m2oJkIzEvTSZRkxGPJAaduyIHjjjmZgXLFxnQqUBHrOANYoPJLyxJtN1UrEAjcZL3okCs3I4zv2hknmiV6gqFNPYVptU6b1k8MJPbiUpwxxfZt+ZInyad8egb9V3FLp6M5PU7QEVDHec2PUFONjHSe04yDwv1dYjwTdJx7ZzUzvHHYuBECAwEAAaOCAgswggIHMAsGA1UdDwQEAwIFoDA8BgkrBgEEAYI3FQcELzAtBiUrBgEEAYI3FQiHv+4hg+DuDYfFhR6H2P57woNRTYSKtleCuuwpAgFkAgEVMB0GA1UdDgQWBBQMQ+vWVxhmUh5WEF974KQX3J2JKTAfBgNVHSMEGDAWgBQ1CQik+pfAKExgnMYzrKUCwbrhyzCBmAYDVR0fBIGQMIGNMIGKoIGHoIGEhkBodHRwOi8vcGtpMS5yZWdpb25lLm1hcmNoZS5pdC9jcmwvUmVnaW9uZSUyME1hcmNoZSUyMFN1YkNBMDEuY3JshkBodHRwOi8vcGtpMi5yZWdpb25lLm1hcmNoZS5pdC9jcmwvUmVnaW9uZSUyME1hcmNoZSUyMFN1YkNBMDEuY3JsMIGsBggrBgEFBQcBAQSBnzCBnDBMBggrBgEFBQcwAoZAaHR0cDovL3BraTEucmVnaW9uZS5tYXJjaGUuaXQvYWlhL1JlZ2lvbmUlMjBNYXJjaGUlMjBTdWJDQTAxLmNydDBMBggrBgEFBQcwAoZAaHR0cDovL3BraTIucmVnaW9uZS5tYXJjaGUuaXQvYWlhL1JlZ2lvbmUlMjBNYXJjaGUlMjBTdWJDQTAxLmNydDATBgNVHSUEDDAKBggrBgEFBQcDATAbBgkrBgEEAYI3FQoEDjAMMAoGCCsGAQUFBwMBMA0GCSqGSIb3DQEBCwUAA4ICAQAd15k3Qub5SVaNRr2CfX7MOQnavfienMWejpDn0IORfdk1pDf/+sc8Kd/5N1qaVKY3emCgVpx1lakrbTCHKEiJWzlKQ3nqzTrsP4NVAegybE7srps00KV6IkhurwXf+AV1lCnIm2/0KtCZC8V302CR9vwCk1EVJZQLSGIx4EZGhOhN8dy3GQw/KYBJZs60F2ilXH3VDBS60gmnd0rnfcnZ9QbA3scQzL4ZZImV356sHXGkaL1rsuCq1cOxecVoZ1h0Ase2oieUCCBAffLTtQhcvowYfjJG36LEyIXtLZqed0i+C8ESumxZmgsOrNIRxem36Dt2u1CAX+oD8M/4+tzzVkDHy2WxY4S7VHVKXvYC8NkQMlD3NkurduLQ6r1RkoLgQBeLAXOFMV3J7nw8fnP8vQ4nHgposzlEefcOJl1iIhn8CQKAqHDUIRqYRMfM/vRgkK18iyYkUo2T0bzji1CSHXnTn9k9BCFKJLc7iv7p8isslOoqnFdkHZI4LTVENTYhklwlA1E/0baevMv6rwtJp5zFoWOZUCvfshdUt90apYY2NmWBPJyE5x7plqMPIzwtccPWc4/Az9tmBRHewi8a3YEE99R6W/w8vfM4TKAbkHBkpS1ue6WAWfzEQEqfdkSN57c5pk54unkvYnMum5sS4juuReRb5aKqgmvh4GzO8A==\n            &lt;/X509Certificate&gt;\n        &lt;/X509Data&gt;\n    &lt;/KeyInfo&gt;\n    &lt;Object Id=\"SignedXmlId\"&gt;\n        &lt;profile timestamp=\"Tue, 25 Jan 2022 22:02:49 GMT\" xmlns=\"\"&gt;\n            &lt;base&gt;\n                &lt;placeOfBirth&gt;F051&lt;/placeOfBirth&gt;\n                &lt;localita_nascita&gt;ROMA&lt;/localita_nascita&gt;\n                &lt;address&gt;Via dei matti 28 60044 ANCONA AN&lt;/address&gt;\n                &lt;indirizzo_residenza&gt;Via dei matti 28 60044 ANCONA AN&lt;/indirizzo_residenza&gt;\n                &lt;gender&gt;M&lt;/gender&gt;\n                &lt;sesso&gt;M&lt;/sesso&gt;\n                &lt;digitalAddress&gt;xxxxxxxxxxx@pec.it&lt;/digitalAddress&gt;\n                &lt;email_certificata&gt;xxxxxxxxxxx@pec.it&lt;/email_certificata&gt;\n                &lt;familyName&gt;ROSSI&lt;/familyName&gt;\n                &lt;cognome&gt;ROSSI&lt;/cognome&gt;\n                &lt;name&gt;MARIO&lt;/name&gt;\n                &lt;nome&gt;MARIO&lt;/nome&gt;\n                &lt;dateOfBirth&gt;1985-04-18&lt;/dateOfBirth&gt;\n                &lt;data_nascita&gt;18/04/1985&lt;/data_nascita&gt;\n                &lt;spidCode&gt;NAMI0002653481&lt;/spidCode&gt;\n                &lt;countyOfBirth&gt;RM&lt;/countyOfBirth&gt;\n                &lt;provincia_nascita&gt;RM/provincia_nascita&gt;\n                &lt;fiscalNumber&gt;TINIT-RSSMRA85D18F051Y&lt;/fiscalNumber&gt;\n                &lt;codice_fiscale&gt;RSSMRA85D18F051Y&lt;/codice_fiscale&gt;\n                &lt;email&gt;mario.rossi@regione.marche.it&lt;/email&gt;\n                &lt;companyFiscalNumber/&gt;\n                &lt;tipo_autenticazione&gt;PIN&lt;/tipo_autenticazione&gt;\n                &lt;login&gt;RSSMRA85D18F051Y&lt;/login&gt;\n                &lt;samlResponseBase64&gt;PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgi...&lt;/samlResponseBase64&gt;\n            &lt;/base&gt;\n        &lt;/profile&gt;\n    &lt;/Object&gt;\n</code></pre> <p>Gli attributi dell'utente sono contenuti nell'oggetto Object. Gli attributi restituiti possono variare in base all'Identity Provider, al livello di autenticazione e dalle impostazioni dell'utente.</p> <p>NOTA BENE: Object contiene anche il token SAML in <code>samlResponseBase64</code> il cui valore \u00e8 quello della SAMLResponse originale restituita dall'Identity Provider scelto dall'utente.</p>"},{"location":"Flusso-di-Autenticazione/#come-effettuare-il-logout","title":"Come effettuare il logout","text":"<p>Per effettuare correttamente il logout, \u00e8 necessario intervenire su due fronti: sessione operativa e browser.</p>"},{"location":"Flusso-di-Autenticazione/#1-logout-della-sessione-operativa","title":"1. Logout della sessione operativa","text":"<p>Il logout lato sessione operativa si effettua effettuando una chiamata allo stesso endpoint utilizzato per ottenere gli attributi dell\u2019utente, modificando il valore del parametro <code>Operation</code> da <code>GetCredential</code> a <code>LogoutSito</code>.</p> <p>Questa chiamata deve essere eseguita in modalit\u00e0 server to server, ovvero deve essere inviata direttamente dal backend dell\u2019applicazione.</p>"},{"location":"Flusso-di-Autenticazione/#esempio-di-chiamata","title":"Esempio di chiamata:","text":"<pre><code>GET https://cohesion2.regione.marche.it/SPManager/webCheckSessionSSO.aspx\n     ?Operation=LogoutSito\n     &amp;IdSessioneSSO=A5D64899EBCEE1FA6B3E8FB3D3D358D7E5843EA25EDFD62277CACE8A5EF23B1C5E6FAB916F333B0AFB0FAE6C4CDF7B8E8DEE461E8661DB04F5FFB01BC0EF9FCB90EEA2ACA7988119EFE17D5C3BB58BC890D75D724D434D7D60C2F451F6A51D1DFFA900EF0AAA631A51458860C6CEC7B1EBC525561624208066DF276314F41F6EC258CA3F\n     &amp;IdSessioneASPNET=ufrq00x4f0cq2yog2ozv4lxx;\n     https://idp.namirialtsp.com/idp;\n     https://q-marche.turitweb.it/LogOff;\n     AAdzZWNyZXQxGLSQhZFb4TSPKKPNCGfO5MaCcJ99DiuEnIzpO4YvtOrgf+6qvwyEVOguFDCVbyPcZ2hhjbBtPtuCWUGs+FYX9zREfvZ1heshK7yzE24MU7JsIBK17atMdbL31QbDPNKbH2wiswXhL2CJGjY=;\n     AAdzZWNyZXQxGLSQhZFb4TSPKKPNCGfO5MaCcJ99DiuEnIzpO4YvtOrgf+6qvwyEVOguFDCVbyPcZ2hhjbBtPtuCWUGs+FYX9zREfvZ1heshK7yzE24MU7JsIBK17atMdbL31QbDPNKbH2wiswXhL2CJGjY=\n</code></pre>"},{"location":"Flusso-di-Autenticazione/#2-logout-del-browser","title":"2. Logout del browser","text":"<p>Il logout lato browser richiede che il browser dell\u2019utente venga rediretto a una specifica URL. Questa operazione consente l\u2019eliminazione dei cookie di autenticazione salvati nel browser.</p> <p>La URL da utilizzare \u00e8 la seguente:</p> <p><code>https://cohesion2.regione.marche.it/SPManager/Logout.aspx</code></p>"},{"location":"Informativa-Cookie/","title":"Informativa Cookie","text":""},{"location":"Informativa-Cookie/#informativa-sui-cookie-e-sul-trattamento-dei-dati-personali-nei-siti-che-integrano-il-framework-di-autenticazione-regionale-cohesion-e-i-siti-della-regione-marche","title":"Informativa sui cookie e sul trattamento dei dati personali nei siti che integrano il framework di autenticazione regionale Cohesion e i siti della Regione Marche.","text":"<p>Modalit\u00e0 di gestione del sito in riferimento al trattamento dei dati personali degli utenti che lo consultano.</p>"},{"location":"Informativa-Cookie/#1-perche-questo-avviso","title":"1. Perch\u00e9 questo avviso","text":"<p>Si tratta di un'informativa che \u00e8 resa, ai sensi dell'art. 13 del d.lgs. n. 196/2003 - Codice in materia di protezione dei dati personali, a coloro che interagiscono in generale con il framework di autenticazione Cohesion id e con i siti della Regione Marche.</p> <p>L'informativa si ispira anche alla Raccomandazione n. 2/2001, che le autorit\u00e0 europee per la protezione dei dati personali, riunite nel Gruppo istituito dall\u2019art. 29 della direttiva n. 95/46/CE, hanno adottato il 17 maggio 2001 per individuare alcuni requisiti minimi per la raccolta di dati personali online e, in particolare, le modalit\u00e0, i tempi e la natura delle informazioni che i titolari del trattamento devono fornire agli utenti quando questi si collegano a pagine web, indipendentemente dagli scopi del collegamento.</p>"},{"location":"Informativa-Cookie/#2-tipi-di-dati-trattati","title":"2. Tipi di dati trattati","text":"<p>Regione Marche, in qualit\u00e0 di titolare del trattamento, rende noto che a seguito dell\u2019inserimento di proprie informazioni su questo sito o tramite l\u2019autenticazione a servizi web possono essere trattati dati relativi a persone identificate o identificabili.</p>"},{"location":"Informativa-Cookie/#21-cookie","title":"2.1 Cookie","text":""},{"location":"Informativa-Cookie/#211-finalita-di-utilizzo-dei-cookie","title":"2.1.1 Finalit\u00e0 di utilizzo dei cookie","text":"<p>I siti della Regione Marche utilizzano alcuni cookie per rendere i propri servizi semplici da navigare e fruire in modo efficiente. I cookie utilizzati consentono inoltre di migliorare il servizio reso agli utenti, rendendo pi\u00f9 efficace l\u2019uso dello stesso e/o abilitando determinate funzionalit\u00e0. </p>"},{"location":"Informativa-Cookie/#212-cookie-utilizzati","title":"2.1.2 Cookie utilizzati","text":"<p>I siti della Regione Marche utilizzano solo cookie tecnici di due tipi: cookie di sessione per l\u2019autenticazione e cookie di monitoraggio (Google Analytics). </p> <ul> <li>Cookie di sessione</li> </ul> <p>I cookie di sessione utilizzati sono indispensabili per gestire l\u2019autenticazione alle aree riservate. L\u2019uso di tali cookie \u00e8 strettamente limitato alla trasmissione di identificativi di sessione necessari per consentire l\u2019esplorazione sicura ed efficiente del sito. Non vengono memorizzati in maniera persistente sul computer dell\u2019utente, sono criptati ed hanno la scadenza.</p> <p>La disabilitazione di questi cookie non consente l\u2019utilizzo della parte riservata del portale.</p> <ul> <li>Cookie analitici/di monitoraggio di terze parti</li> </ul> <p>Nessun dato personale degli utenti viene in proposito acquisito dal sito. Non viene fatto uso di cookie per la trasmissione di informazioni di carattere personale, n\u00e9 vengono utilizzati cookie persistenti di alcun tipo, ovvero sistemi per il tracciamento degli utenti. L'uso di cookie di sessione (che non vengono memorizzati in modo persistente sul computer dell'utente e svaniscono con la chiusura del browser) \u00e8 strettamente limitato alla trasmissione di identificativi di sessione (costituiti da numeri casuali generati dal server) necessari per consentire l'esplorazione sicura ed efficiente del sito. I cookie di sessione utilizzati in questo sito evitano il ricorso ad altre tecniche informatiche potenzialmente pregiudizievoli per la riservatezza della navigazione degli utenti e non consentono l'acquisizione di dati personali identificativi dell'utente. L'utilizzo di cookie permanenti \u00e8 strettamente limitato all'acquisizione di dati statistici relativi all'accesso al sito.</p> <p>Per scopi statistici, il sito si avvale di un prodotto per la rilevazione degli accessi. In particolare, il sito utilizza Matomo, un software open source di analisi web che garantisce piena compatibilit\u00e0 con le leggi europee relative alla protezione dei dati. Per analizzare i punti di maggiore interesse dei siti visitati dall\u2019utente, Matomo utilizza i cookie a scopi statistici e raccoglie informazioni in sola forma aggregata. Sul sito di Web Analytics Italia \u00e8 possibile consultare la policy relativa alla privacy.</p>"},{"location":"Informativa-Cookie/#213-siti-web-e-servizi-di-terze-parti","title":"2.1.3 Siti web e servizi di terze parti","text":"<p>I siti della Regione Marche potrebbero contenere collegamenti ad altri siti web che dispongono di una propria informativa privacy. La Regione Marche non risponde del trattamento dei dati svolto da tali siti.</p>"},{"location":"Informativa-Cookie/#214-come-disabilitare-i-cookie","title":"2.1.4 Come disabilitare i cookie","text":"<ul> <li>Per disabilitare tutti i cookie</li> </ul> <p>\u00c8 possibile negare il consenso all\u2019utilizzo dei cookie selezionando l'impostazione appropriata sul proprio browser.</p> <p>Si forniscono di seguito i link che spiegano come disabilitare i cookie per i browser pi\u00f9 diffusi (per altri browser eventualmente utilizzati suggeriamo di cercare questa opzione nell\u2019help del software).</p> <p>Guide per disabilitare i cookie nei principali browser:     - Internet Explorer     - Google Chrome     - Mozilla Firefox     - Opera     - Apple Safari</p> <ul> <li>Per disabilitare soltanto i cookie di Google Analytics</li> </ul> <p>\u00c8 possibile disabilitare solo i cookie di Google Analytics utilizzando il componente aggiuntivo di opt-out fornito da Google.</p> <ul> <li>Per cancellare cookie gi\u00e0 memorizzati sul terminale</li> </ul> <p>Anche se viene revocata l\u2019autorizzazione all\u2019utilizzo di cookie di terze parti, prima di tale revoca i cookie potrebbero essere stati memorizzati sul terminale dell\u2019utente. Per motivi tecnici non \u00e8 possibile cancellare tali cookie, tuttavia il browser dell\u2019utente consente la loro eliminazione tra le impostazioni sulla privacy. Le opzioni del browser contengono infatti l\u2019opzione \u201cCancella dati di navigazione\u201d che pu\u00f2 essere utilizzata per eliminare i cookies, dati di siti e plug-in. </p>"},{"location":"Informativa-Cookie/#22-dati-forniti-volontariamente-dallutente","title":"2.2 Dati forniti volontariamente dall\u2019utente","text":"<p>L'invio facoltativo, esplicito e volontario di posta elettronica, messaggi o qualsiasi tipo di comunicazioni indirizzai recapiti indicati sui portali di Regione Marche  comporta la successiva acquisizione dell'indirizzo del mittente o di eventuali altri dati personali che saranno utilizzati per rispondere alle richieste. Si assicura, che tale trattamento sar\u00e0 improntato ai principi di correttezza, liceit\u00e0 e trasparenza e di tutela della riservatezza come indicato nel decreto legislativo 196/03. Specifiche informative di sintesi verranno progressivamente riportate o visualizzate nelle pagine dei siti predisposte per particolari servizi a richiesta. </p>"},{"location":"Informativa-Cookie/#3-il-titolare-del-trattamento","title":"3. Il Titolare del trattamento","text":"<p>Il Titolare dei dati \u00e8 Regione Marche, con sede in via Gentile da Fabriano, 9 - 60125 Ancona.</p> <p>I \"Responsabili del trattamento\" sono i direttori delle strutture amministrative, di servizio, di posizione di funzione da cui vengono trattati i dati.</p> <p>Il trattamento di dati personali connessi ai servizi web dei siti della Regione Marche, di cui ai punti 2.1 e 2.2, hanno luogo presso i Responsabili del trattamento dei dati: Consulta i nominativi dei responsabili di tali strutture amministrative.</p> <p>L\u2019elenco degli amministratori dei sistemi centralizzati di Regione Marche essere fornito su richiesta dell\u2019interessato scrivendo all\u2019amministrazione.</p>"},{"location":"Informativa-Cookie/#4-facoltativita-del-conferimento-dei-dati","title":"4. Facoltativit\u00e0 del conferimento dei dati","text":"<p>A parte quanto specificato per i cookie e i dati di navigazione, l'utente \u00e8 libero di fornire i dati personali riportati nei moduli o nei form presenti sui siti della Regione Marche  o comunque indicati in occasione di contatti con l'Amministrazione per sollecitare l'invio di materiale informativo, di altre comunicazioni o per accedere a servizi specifici. Il loro mancato conferimento pu\u00f2 comportare l'impossibilit\u00e0 di ottenere quanto richiesto.</p>"},{"location":"Informativa-Cookie/#5-modalita-del-trattamento","title":"5. Modalit\u00e0 del trattamento","text":"<p>I dati personali sono trattati esclusivamente per fini istituzionali, con strumenti automatizzati per il tempo strettamente necessario a conseguire gli scopi per cui sono stati raccolti. Specifiche misure di sicurezza sono osservate per prevenire la perdita dei dati, usi illeciti o non corretti ed accessi non autorizzati.</p>"},{"location":"Informativa-Cookie/#6-diritti-degli-interessati","title":"6. Diritti degli interessati","text":"<p>Ai sensi dell\u2019art. 7 del d.lgs. n. 196/2003, il soggetto cui si riferiscono i dati personali, ha il diritto di:</p> <p>ottenere la conferma dell'esistenza o meno di dati che lo riguardano, anche se non ancora registrati, e la loro comunicazione in forma intelligibile.</p> <p>ottenere l\u2019indicazione:</p> <ol> <li>dell'origine dei dati personali;</li> <li>delle finalit\u00e0 e modalit\u00e0 del trattamento;</li> <li>della logica applicata in caso di trattamento effettuato con l'ausilio di strumenti elettronici;</li> <li>degli estremi identificativi del titolare, dei responsabili e del rappresentante designato ai sensi dell'articolo 5, comma 2;</li> <li>dei soggetti o delle categorie di soggetti ai quali i dati personali possono essere comunicati o che possono venirne a conoscenza in qualit\u00e0 di rappresentante designato nel territorio dello Stato, di responsabili o incaricati.</li> </ol> <p>di ottenere:</p> <ol> <li>l'aggiornamento, la rettificazione ovvero, quando vi ha interesse, l'integrazione dei dati;</li> <li>la cancellazione, la trasformazione in forma anonima o il blocco dei dati trattati in violazione di legge, compresi quelli di cui non \u00e8 necessaria la conservazione in relazione agli scopi per i quali i dati sono stati raccolti o successivamente trattati;</li> <li>l'attestazione che le operazioni di cui alle lettere a) e b) sono state portate a conoscenza, anche per quanto riguarda il loro contenuto, di coloro ai quali i dati sono stati comunicati o diffusi, eccettuato il caso in cui tale adempimento si rivela impossibile o comporta un impiego di mezzi manifestamente sproporzionato rispetto al diritto tutelato.</li> </ol> <p>di opporsi, in tutto o in parte:</p> <ol> <li>per motivi legittimi al trattamento dei dati personali che lo riguardano, ancorch\u00e8 pertinenti allo scopo della raccolta;</li> <li>al trattamento di dati personali che lo riguardano a fini di invio di materiale pubblicitario o di vendita diretta o per il compimento di ricerche di mercato o di comunicazione commerciale.</li> </ol> <p>La presente Privacy Policy sar\u00e0 soggetta ad aggiornamenti.</p> <p>FONTI</p> <ul> <li> <p>https://s3.amazonaws.com/iprs/files/attachments/20155 17bfe609-832b-4eb5-bd95-55239b5ae4f1__O.pdf</p> </li> <li> <p>http://blog.cookies.coffee/privacy-il-provvedimento-del-garante-sui-cookie/</p> </li> <li> <p>http://ec.europa.eu/ipg/basics/legal/cookies/index_en.htm</p> </li> <li> <p>http://www.unibo.it/</p> </li> <li> <p>https://www.iubenda.com/privacy-policy/775731/cookie-policy?an=no&amp;s_ck=false</p> </li> <li> <p>http://garanteprivacy.it/web/guest/home/docweb/-/docweb-display/docweb/3118884</p> </li> <li> <p>http://www.garanteprivacy.it/web/guest/home/docweb/-/docweb-display/docweb/3167231</p> </li> <li> <p>https://www.iubenda.com/it/cookie-law-e-soluzioni-iubenda</p> </li> <li> <p>http://www.webintesta.it/normativa-cookie-law-italia/</p> </li> </ul>"},{"location":"Integrazione-.NET-Core-8/","title":"Integrazione .NET Core 8","text":""},{"location":"Integrazione-.NET-Core-8/#cohesion2netcore","title":"Cohesion2NETCore","text":"<p>Adattamento della classe CohesionSSO.cs per l'utilizzo con .NET Core.</p>"},{"location":"Integrazione-.NET-Core-8/#per-integrare-cohesion","title":"Per integrare Cohesion","text":"<p>Per integrare l'autenticazione in Cohesion nel proprio sito \u00e8 sufficiente aggiungere la classe C# CohesionSSO.cs al proprio progetto .NET Core e richiamare i metodi <code>ValidateFE</code> e <code>LogoutFE</code>. I metodi vanno richiamati dopo aver inizializzato la classe mediante il costruttore disponibile ed utilizzando la programmazione asincrona tramite i costrutti <code>async</code> e <code>await</code>.</p> <p>Una volta autenticati, il token di autenticazione verr\u00e0 automaticamente salvato nella variabile di sessione <code>token</code>, che conterr\u00e0 l'XML con le informazioni specifiche dell'utente.</p> <p>La classe utilizza la cookie authentication: nel cookie viene automaticamente registrato il codice fiscale dell'utente (nodo <code>&lt;login&gt;</code> del token).</p> <p>Il costruttore della classe prevede i seguenti parametri, eventualmente definibili nel file <code>appsettings.json</code> del progetto:</p> <ul> <li><code>HttpContext</code>: contesto HTTP dal quale vengono automaticamente estrapolate le informazioni relative alla richiesta, alla risposta e alla sessione</li> <li><code>SSOCheckURL</code>: parametro fisso della pagina SSO di Cohesion</li> <li><code>SSOWebCheckSessionURL</code>: parametro fisso della pagina di recupero token di autenticazione</li> <li><code>SuccessURL</code>: URL a cui si viene reindirizzati se l'autenticazione \u00e8 andata a buon fine</li> <li><code>ErrorURL</code>: URL a cui si viene reindirizzati in caso di errore di autenticazione</li> <li><code>SSOAdditionalData</code>: parametri opzionali di autenticazione</li> <li><code>IdSito</code>: fornito dalla Regione Marche al momento dell'abilitazione a Cohesion</li> </ul> <p>Di seguito un esempio di codice (pattern MVC) in cui i metodi vengono richiamati all'interno delle action <code>Login</code> e <code>Logout</code> di un controller <code>AccountController</code>:</p> <pre><code>public class AccountController : Controller\n{\n    private readonly IHttpContextAccessor _httpContextAccessor;\n    private readonly CohesionSettingsOptions _cohesionOptions;\n\n    public AccountController(IHttpContextAccessor httpContextAccessor, IOptions&lt;CohesionSettingsOptions&gt; cohesionOptions)\n    {\n        _httpContextAccessor = httpContextAccessor;\n        _cohesionOptions = cohesionOptions.Value;\n    }\n\n    public async Task Login()\n    {\n        var httpContext = _httpContextAccessor.HttpContext;\n\n        if (httpContext == null)\n        {\n            return;\n        }\n\n        var request = httpContext.Request;\n        var response = httpContext.Response;\n        var session = httpContext.Session;\n\n        if (request == null || response == null || session == null)\n        {\n            return;\n        }\n\n        var cohesionSSO = new CohesionSSO(httpContext, _cohesionOptions.SSOCheckURL, _cohesionOptions.SSOWebCheckSessionURL, _cohesionOptions.SuccessURL, _cohesionOptions.ErrorURL, _cohesionOptions.SSOAdditionalData, _cohesionOptions.IdSito);\n        await cohesionSSO.ValidateFE();\n    }\n\n    public async Task Logout()\n    {\n        var httpContext = _httpContextAccessor.HttpContext;\n\n        if (httpContext == null)\n        {\n            return;\n        }\n\n        var request = httpContext.Request;\n        var response = httpContext.Response;\n        var session = httpContext.Session;\n\n        if (request == null || response == null || session == null)\n        {\n            return;\n        }\n\n        var cohesionSSO = new CohesionSSO(httpContext, _cohesionOptions.SSOCheckURL, _cohesionOptions.SSOWebCheckSessionURL, _cohesionOptions.SuccessURL, _cohesionOptions.ErrorURL, _cohesionOptions.SSOAdditionalData, _cohesionOptions.IdSito);\n        await cohesionSSO.LogoutFE();\n    }\n}\n</code></pre> <p>Per ulteriori dettagli, fare riferimento al codice della classe e alla documentazione ufficiale disponibile nela sezione Integrazione Classe C#.</p>"},{"location":"Integrazione-C-Sharp-Core/","title":"Integrazione C# Core","text":"<p>Con il presente si vuole fornire una panoramica completa delle modalit\u00e0 di integrazione e delle configurazioni di utilizzo del Service Provider fornito con Cohesion in applicativi web che richiedono autenticazione e profilazione utente. Verr\u00e0 in dettaglio descritta la procedura di installazione in ambiente IIS mediante classe C# CohesionSSO.cs e la configurazione per l\u2019utilizzo classico ed il funzionamento in modalit\u00e0 federata SAML2.0. Questa modalit\u00e0 \u00e8 sempre preferibile e in particolare \u00e8 necessaria qualora non venga rilasciato all\u2019ente un certificato personale per la comunicazione con Cohesion.</p>"},{"location":"Integrazione-C-Sharp-Core/#come-integrarlo-nel-proprio-applicativo","title":"Come integrarlo nel proprio applicativo","text":"<p>Demo asp net core</p> <p>In questa pagina \u00e8 presente un'applicativo di test di autenticazione Cohesion su asp net core in modo da poter provare le funzionalit\u00e0. Nella repo della demo sono indicati i requisiti ed i passaggi da eseguire per integrare l'autenticazione cohesion nel proprio applicativo vengono indicati i requisiti e come fare per integrare Cohesion.</p>"},{"location":"Integrazione-C-Sharp-Core/#cohesionservicecs","title":"CohesionService.cs","text":"<p>Questo service mette a disposizione una serie di metodi che permettono di gestire tutti i passaggi dell'autenticazione tramite cohesion partendo dal login fino alla richiesta di logout.</p>"},{"location":"Integrazione-C-Sharp-Core/#il-metodo-requestauth","title":"Il metodo \"RequestAuth\"","text":"<p><code>RequestAuth(string urlValidation, string urlReturn)</code></p> <p>crea un base64 di una richiesta di login a cohesion dove sono richiesti 2 parametri:</p> <ul> <li>urlValidation - ovvero l'url del metodo che andr\u00e0 a gestire la validazione della richiesta di login</li> <li>urlReturn - ovvero l'url dove si vorr\u00e0 reindirizzare l'utente una volta effettuata la richiesta di login con successo</li> </ul> <p>infine ritorna un url dove verr\u00e0 rindirizzato l'utente per effettuare correttamente il login di cohesion.</p>"},{"location":"Integrazione-C-Sharp-Core/#il-metodo-checkauth","title":"Il metodo \"CheckAuth\"","text":"<p><code>CheckAuth(string auth)</code></p> <p>verifica se la richiesta di login a cohesion ha avuto esito positivo o negativo restituendo un oggetto \"AuthCohesionCheckResponse\".</p>"},{"location":"Integrazione-C-Sharp-Core/#il-metodo-logoutfe","title":"Il metodo \"LogoutFE\"","text":"<p><code>LogoutFE(_session)</code></p> <p>\u00e8 utilizzato per effettuare la richiesta logout passando al metodo la sessione attuale dell'utente dove \u00e8 possibile, se presenti, estrapolare i parametri di login ed effettuare correttamente il logout.</p>"},{"location":"Integrazione-C-Sharp-Core/#appsettingsjson","title":"appsettings.json","text":"<p>Nel file appsettings.json \u00e8 necessario impostare dei valori per il corretto funzionamento dell'autenticazione tramite cohesion.</p> <p>In particolare andranno impostate le seguenti chiavi:</p> <ul> <li>sso.check.url : parametro fisso della pagina SSO di Cohesion.</li> <li>webCheckSessionSSO : parametro fisso della pagina di recupero token di autenticazione.</li> <li>sso.additionalData : parametri opzionali di autenticazione.</li> <li>site.URLLogout : url della propria pagina di logout relativo alla posizione della pagina protetta; \u00e8 possibile specificare il parametro ReturnUrl con l'url della pagina a cui ritornare una volta effettuato il logout.</li> <li>site.id_sito: IDSito fornito da Regione Marche la momento della abilitazione alla integrazione cohesion.</li> <li>site.IndexURL: url della propria pagina a cui ritornare in caso di errore di autenticazione.</li> </ul> <p>Esempio di codice di configurazione in appsettings.json:</p> <pre><code>\"AppSettings\": {\n    \"SSOcheckUrl\": \"https://cohesion2.regione.marche.it/SPManager/WAYF.aspx\",\n    \"SSOwebCheckSession\": \"https://cohesion2.regione.marche.it/SPManager/webCheckSessionSSO.aspx\",\n    \"SSOadditionalData\": \"AuthRestriction=0,1,2,3;https://MYSITE/Account/LogOff\",\n    \"SiteIndexUrl\": \"https://MYSITE/Account/Login\",\n    \"SiteUrlLogout\": \"../Logout.aspx?ReturnUrl=https%3A%2F%2Fcohesion2.regione.marche.it%2FSPManager%2FLogout.aspx\",\n    \"SiteIdSito\": \"MYSITE\"\n  }\n</code></pre> <p>Di seguito verranno descritti i campi che \u00e8 possibile cambiare:</p> <ul> <li>site.URLLogout: Contiene l\u2019url della pagina di Logout dalla posizione della pagina autenticata. A differenza della modalit\u00e0 classica non \u00e8 per\u00f2 possibile cambiare il parametro ReturnUrl in quanto strettamente dipendente alle funzionalit\u00e0 di logout di SAML.</li> <li>site.IndexURL: se presente deve contenere l\u2019url della propria pagina a cui ritornare in caso di errore di autenticazione.</li> <li>sso.additionalData: Deve contenere obbligatoriamente il percorso completo della propria pagina di logout affinch\u00e9 il logout SAML funzioni correttamente. Pu\u00f2 contenere altri due parametri opzionali: i livelli di autenticazione da mostrare (parametro AuthRestriction) e un flag per mostrare solo i meccanismi di accesso federato SPID, CIEID, CNS e l'accesso tramite dominio. I vari parametri vanno separati da punto e virgola \";\".</li> </ul> <p>Per approfondimenti in merito alla configurazione dei parametri addizionali, \u00e8 possibile far riferimento alla pagina Parametri della Richiesta di Autenticazione</p> <p>[Opzionale]</p> <p>Prima dell'URL di logout \u00e8 possibile inserire la stringa AuthRestricion=0,1,2,3 dove i valori 0,1,2,3 indicano i livelli di autenticazione da mostrare nella pagina di login dell\u2019Idp federato selezionato, in particolare:</p> <ul> <li>0 indica di mostrare l'autenticazione SAML \"Password\"</li> <li>1 indica di mostrare l'autenticazione SAML \"Smartcard\"</li> <li>2 indica di mostrare l'autenticazione SAML \"SmartcardPKI\"</li> <li>3 indica di mostrare l'autenticazione SAML \"Kerberos\"</li> </ul> <p>I seguenti valori sono standard SAML e dovrebbero essere riconosciuti per ogni IdP federato selezionato. Nel caso venga scelto Cohesion come Idp allora i valori saranno interpretati con le modalit\u00e0 di autenticazione gi\u00e0 descritte nel punto a), a meno che non venga specificato l'altro parametro opzionale UType=c. </p> <p>E\u2019 possibile nascondere o visualizzare le modalit\u00e0 di autenticazione togliendo o aggiungendo i rispettivi valori separati da una virgola. L\u2019ordine non \u00e8 influente.</p> <p>[Opzionale]</p> <p>Dopo l'URL di logout \u00e8 possibile inserire la stringa eidas=1. L'inserimento di questa stringa abilita la login eIDAS nel sistema di autenticazione SAML 2.0 di Cohesion. Questa opzione \u00e8 compatibile con tutte le altre fin qui indicate. </p> <p>ES: AuthRestriction=2,1;http://host/YOURSITE/Logout.aspx;UType=c;eidas=1</p>"},{"location":"Integrazione-Classe-C-Sharp/","title":"Integrazione classe C#","text":"<p>Con il presente si vuole fornire una panoramica completa delle modalit\u00e0 di integrazione e delle configurazioni di utilizzo del Service Provider fornito con Cohesion in applicativi web che richiedono autenticazione e profilazione utente. Verr\u00e0 in dettaglio descritta la procedura di installazione in ambiente IIS mediante classe C# CohesionSSO.cs e la configurazione per l\u2019utilizzo classico ed il funzionamento in modalit\u00e0 federata SAML2.0. Questa modalit\u00e0 \u00e8 sempre preferibile e in particolare \u00e8 necessaria qualora non venga rilasciato all\u2019ente un certificato personale per la comunicazione con Cohesion.</p> <p>Scarica l'applicazione di test e la classe di integrazione</p> <p>Per integrare l\u2019autenticazione in Cohesion nel proprio sito \u00e8 sufficiente aggiungere la classe C# CohesionSSO.cs al proprio progetto .NET e richiamare i metodi ValidateFE e LogoutFE rispettivamente nel codice della pagina che gestisce la form authentication e della pagina di logout. I metodi vanno richiamati dopo aver inizializzato la classe mediante i costruttori disponibili. Di seguito un esempio di codice da inserire nella pagina di form authentication:</p> <p><code>CohesionSSO cohesionSSO = new CohesionSSO(Request, Response, Session);  cohesionSSO.ValidateFE();</code></p> <p>Una volta autenticati il token di autenticazione verr\u00e0 automaticamente salvato nella variabile di sessione \u201cTOKEN\u201d.</p> <p>In TestCohesion.zip \u00e8 presente un esempio di progetto .NET 2010 in cui si mostra come integrare Cohesion mediante la classe CohesionSSO.</p> <p>La classe dispone di 2 costruttori:</p> <p>Costruttore base con i soli parametri per recuperare le variabili di richiesta http, risposta http e sessione http. In questo modo tutti i parametri richiesti dovranno essere specificati nel web.config. </p> <p>In particolare andranno impostate le seguenti chiavi nel web.config:</p> <ul> <li>sso.check.url : parametro fisso della pagina SSO di Cohesion.</li> <li>webCheckSessionSSO : parametro fisso della pagina di recupero token di autenticazione.</li> <li>sso.additionalData : parametri opzionali di autenticazione.</li> <li>site.URLLogout : url della propria pagina di logout relativo alla posizione della pagina protetta; \u00e8 possibile specificare il parametro ReturnUrl con l'url della pagina a cui ritornare una volta effettuato il logout.</li> <li>site.id_sito: IDSito fornito da Regione Marche la momento della abilitazione alla integrazione cohesion.</li> <li>site.IndexURL: url della propria pagina a cui ritornare in caso di errore di autenticazione.</li> </ul> <p>Esempio di codice di configurazione in web.config:</p> <pre><code>&lt;appSettings&gt;\n &lt;add key=\"sso.check.url\" value=\"http://cohesion2.regione.marche.it/SSO/Check.aspx\"/&gt;\n &lt;add key=\"sso.webCheckSessionSSO\" value=\"https://cohesion2.regione.marche.it/SSO/webCheckSessionSSO.aspx\"/&gt;\n &lt;add key=\"sso.additionalData\" value=\"\"/&gt;\n &lt;add key=\"site.URLLogout\" value=\"../Logout.aspx?ReturnUrl=index.aspx\"/&gt;\n &lt;add key=\"site.id_sito\" value=\"MYSITE\"/&gt;\n &lt;add key=\"site.IndexURL\" value=\"index.aspx\"/&gt;\n&lt;/appSettings&gt;\n</code></pre> <p>Costruttore completo con tutti i parametri richiesti: In questo modo non si avr\u00e0 bisogno di specificare i parametri nel web.config ma si passeranno direttamente al costruttore:</p> <p><code>CohesionSSO cohesionSSO = new CohesionSSO(request, response, session, SSOCheckUrl, webCheckSessionSSOUrl, additionalData, indexUrl);</code></p> <p>Di seguito viene descritto un esempio di configurazione di questi parametri per utilizzare rispettivamente la modalit\u00e0 di funzionamento classica di Cohesion e la modalit\u00e0 di funzionamento federato mediante standard SAML2.0</p> <p>Modalit\u00e0 di funzionamento SAML2.0</p> <pre><code>&lt;appSettings&gt;\n &lt;add key=\"sso.check.url\" value=\"http://cohesion2.regione.marche.it/SPManager/WAYF.aspx\"/&gt;\n &lt;add key=\"sso.webCheckSessionSSO\" value=\"https://cohesion2.regione.marche.it/SPManager/webCheckSessionSSO.aspx\"/&gt;\n &lt;add key=\"site.URLLogout\" \n value= \"../Logout.aspx?ReturnUrl=https%3A%2F%2Fcohesion2.regione.marche.it%2FSPManager%2FLogout.aspx\"/&gt;\n &lt;add key=\"site.IndexURL\" value=\"index.aspx\"/&gt;\n &lt;add key=\"site.id_sito\" value=\"MYSITE\"/&gt;\n &lt;add key=\"sso.additionalData\" value=\"http://YOURHOST/YOURSITE/Logout.aspx\"/&gt;\n&lt;/appSettings&gt;\n</code></pre> <p>Di seguito verranno descritti i campi che \u00e8 possibile cambiare:</p> <ul> <li>site.URLLogout: Contiene l\u2019url della pagina di Logout dalla posizione della pagina autenticata. A differenza della modalit\u00e0 classica non \u00e8 per\u00f2 possibile cambiare il parametro ReturnUrl in quanto strettamente dipendente alle funzionalit\u00e0 di logout di SAML.</li> <li>site.IndexURL: se presente deve contenere l\u2019url della propria pagina a cui ritornare in caso di errore di autenticazione.</li> <li>sso.additionalData: Deve contenere obbligatoriamente il percorso completo della propria pagina di logout affinch\u00e9 il logout SAML funzioni correttamente. Pu\u00f2 contenere altri due parametri opzionali: i livelli di autenticazione da mostrare (parametro AuthRestriction) e un flag per mostrare solo i meccanismi di accesso federato SPID, CIEID, CNS e l'accesso tramite dominio. I vari parametri vanno separati da punto e virgola \";\".</li> </ul> <p>Per approfondimenti in merito alla configurazione dei parametri addizionali, \u00e8 possibile far riferimento alla pagina Parametri della Richiesta di Autenticazione</p> <p>[Opzionale]</p> <p>Prima dell'URL di logout \u00e8 possibile inserire la stringa AuthRestricion=0,1,2,3 dove i valori 0,1,2,3 indicano i livelli di autenticazione da mostrare nella pagina di login dell\u2019Idp federato selezionato, in particolare: * 0 indica di mostrare l'autenticazione SAML \"Password\" * 1 indica di mostrare l'autenticazione SAML \"Smartcard\" * 2 indica di mostrare l'autenticazione SAML \"SmartcardPKI\" * 3 indica di mostrare l'autenticazione SAML \"Kerberos\"</p> <p>I seguenti valori sono standard SAML e dovrebbero essere riconosciuti per ogni IdP federato selezionato. Nel caso venga scelto Cohesion come Idp allora i valori saranno interpretati con le modalit\u00e0 di autenticazione gi\u00e0 descritte nel punto a), a meno che non venga specificato l'altro parametro opzionale UType=c. E\u2019 possibile nascondere o visualizzare le modalit\u00e0 di autenticazione togliendo o aggiungendo i rispettivi valori separati da una virgola. L\u2019ordine non \u00e8 influente.</p> <p>[Opzionale]</p> <p>Dopo l'URL di logout \u00e8 possibile inserire la stringa eidas=1. L'inserimento di questa stringa abilita la login eIDAS nel sistema di autenticazione SAML 2.0 di Cohesion. Questa opzione \u00e8 compatibile con tutte le altre fin qui indicate.  Es. AuthRestriction=2,1;http://host/YOURSITE/Logout.aspx;UType=c;eidas=1</p>"},{"location":"Integrazione-Servlet-Java/","title":"Integrazione mediante servlet Java","text":"<p>Con il presente si vuole fornire una panoramica completa delle modalit\u00e0 di integrazione e delle configurazioni di utilizzo del Service Provider fornito con Cohesion in applicativi web che richiedono autenticazione e profilazione utente. Verr\u00e0 in dettaglio descritta la procedura di installazione in ambiente Java Servlet e la configurazione per l\u2019utilizzo classico ed il funzionamento in modalit\u00e0 federata SAML2.0.</p> <p>Scarica la Servlet Java ed il manuale</p> <p>Scarica la versione per java8 e successive</p> <p>Scarica il keystore valido a partire dal 16/02/2022</p>"},{"location":"Integrazione-Servlet-Java/#prerequisiti","title":"Prerequisiti:","text":"<ul> <li>Apache Tomcat v6+, JBoss, Glassfish</li> <li>Java v 1.6+</li> </ul> <p>La servlet per l\u2019integrazione di Cohesion \u00e8 stata riscritta in modo da essere compatibile anche con qualunque servlet container e non utilizzare librerie esterne e componenti aggiuntivi che ne potrebbero limitare la compatibilit\u00e0.</p> <p>Inoltre \u00e8 stato aggiunto il supporto alla funzionalit\u00e0 di logout, prima assente. Abbiamo quindi la servlet \u201cAuthentication\u201d che fornisce Single Sign On e la servlet \u201cLogout\u201d che effettua il logout da Cohesion. Usando questo pacchetto, Cohesion potr\u00e0 essere integrato in ogni tipologia di sito a prescindere dal linguaggio di progettazione (volendo anche in un sito .NET su IIS).</p> <p>Una volta configurata la servlet e lanciato l\u2019ambiente Tomcat infatti, sar\u00e0 sufficiente creare nel proprio sito una pagina di login che rediriga alla pagina servlet \u201cAuthentication\u201d specificando il parametro ReturnUrl, che dovr\u00e0 contenere l\u2019url della pagina a cui la servlet ritorner\u00e0 il token utente.</p> <p>Tale pagina pu\u00f2 essere la stessa pagina di login, l\u2019importante \u00e8 che sia in grado di processare il token utente ricevuto via POST. Il token \u00e8 firmato, eventualmente crittografato, e codificato in base64, perci\u00f2 la pagina di login dovr\u00e0 riuscire a decodificare la stringa base64, eventualmente decriptare il token mediante la chiave impostata nella servlet (l\u2019algoritmo utilizzato \u00e8 il 3-DES/ECB/NoPadding), ed infine volendo, verificare la firma del token.</p> <p>Quest\u2019ultimo passaggio in realt\u00e0 non \u00e8 strettamente necessario ai fini della sicurezza qualora la connessione ai server Cohesion sia fatta in HTTPS. Questo perch\u00e9 la servlet controlla automaticamente che il certificato SSL della pagina corrisponda effettivamente al nome DNS usato, e in caso negativo ritorna una notifica. </p> <p>Solo dopo questi passaggi si potr\u00e0 autenticare l\u2019utente ed aggiungere il token nella propria sessione.</p> <p>Nel pacchetto vengono fornite due pagine login di esempio; una sviluppata in JSP ed un'altra in PHP, insieme al certificato Cohesion necessario a verificare la firma digitale del token.</p> <p>Per effettuare il logout \u00e8 invece sufficiente creare una pagina di logout che rediriga alla servlet \u201cLogout\u201d. \u00c8 possibile anche in questo caso specificare il parametro ReturnUrl che sar\u00e0 l\u2019indirizzo a cui la servlet ridiriger\u00e0 l\u2019utente una volta effettuata la disconnessione da Cohesion. Nel pacchetto vengono fornite oltre alle pagine di login anche due semplici pagine di logout, una in JSP ed una in PHP.</p> <p>Di seguito verranno elencate le operazioni di configurazione da effettuare:</p> <ol> <li> <p>Effettuare il deploy del WAR: Nel caso di Apache Tomcat come servlet container, copiare il file CohesionServlet.war dentro la cartella webapp e lanciare Tomcat in modo da effettuare automaticamente il deploy della servlet. Nel caso Tomcat sia configurato per non effettuare il deploy automatico \u00e8 sufficiente scompattare il file .war (\u00e8 un archivio zip) nella cartella webapp/CohesionServlet.</p> </li> <li> <p>Importare i certificati CA della Regione Marche presenti nel keystore RegioneMarcheCA.keystore, nel keystore interno di java mediante il comando:</p> </li> </ol> <pre><code>keytool -importkeystore -srckeystore RegioneMarcheCA.keystore\n</code></pre> <p>La password del keystore RegioneMarcheCA.keystore \u00e8 \u201cpassword\u201d mentre la password dell\u2019 keystore java di default dovrebbe essere \u201cchangeit\u201d.</p> <p>Alternativamente a questa procedura \u00e8 possibile lanciare Tomcat o JBoss specificando il keystore da utilizzare per i certificati CA;  I parametri da aggiungere alla variabile di sistema JAVA_OPTS comunemente usata in Tomcat e JBoss sono:</p> <pre><code>-Djavax.net.ssl.trustStore=/path/RegioneMarcheCA.keystore\n-Djavax.net.ssl.trustStorePassword=password\n</code></pre> <ol> <li> <p>Copiare il certificato personale presente nel pacchetto in una cartella sicura (non accessibile via web). Nel caso il certificato abbia estensione .pfx, \u00e8 fondamentale rinominarlo in .p12. Qualora non sia stato fornito un certificato personale insieme alla servlet \u00e8 possibile utilizzare la modalit\u00e0 di recupero sicuro del token di autenticazione specificando il parametro \u201cwebSso\u201d descritto nel punto 4c. In tal caso il parametro \u201cwsSso\u201d presente nel punto 4c e tutti i parametri del punto 4a potranno essere ignorati. Questa \u00e8 la modalit\u00e0 di default con cui viene fornita la servlet.</p> </li> <li> <p>Modificare il file di configurazione nella cartella webapp/CohesionServlet/WEB-INF/web.xml nel caso di Tomcat, impostando i seguenti parametri:</p> </li> </ol> <p>a) Parametri relativi al certificato Qualora fosse stato rilasciato un certificato personale insieme alla servlet, questi parametri andranno obbligatoriamente cambiati in quanto sono specifici per il singolo certificato utente e sono presenti sia per la servlet di autenticazione che per quella di logout:</p> <ul> <li>keystorePath: Inserire il percorso del certificato personale del punto 3).</li> <li>keystoreType: Se il file \u00e8 un .p12 o un .pfx rinominato in .p12 lasciare il valore PKCS12.</li> <li>pwdKeystore: La password che protegge il certificato</li> <li>pwdCertificate: La password che protegge la chiave privata. Solitamente \u00e8 uguale a pwdKeystore</li> <li>aliasCertificate: L'alias del certificato. Per visualizzarlo utilizzare il comando:</li> </ul> <pre><code>keytool -list -keystore &lt;certificato&gt;.p12 -storetype pkcs12\n</code></pre> <p>Il comando \u00e8 presente nella cartella bin di Java e restituir\u00e0 un output simile al seguente:</p> <p><code>be7446f14507a331c1b5b8ff70a66520_d0e8d7b1-bcb5-4128-9d8e-2fc4dc332132</code>, 30-ott-2012, PrivateKeyEntry, Impronta digitale certificato (SHA1): DC:DD:60:1C:9D:43:AF:9B:F7:6E:AE:6B:5A:D5:F7:14:33:D0:0C:5C</p> <p>Il primo valore terminato dalla virgola \u00e8 l'alias da inserire.</p> <p>b) Parametri relativi al token utente restituito</p> <p>Questi parametri sono opzionali e relativi solo all'invio del token tra la servlet e la pagina di login:</p> <ul> <li>encryptionKey:Questo parametro \u00e8 opzionale. Se impostato deve avere una lunghezza fissa di 24 caratteri e permetter\u00e0 di restituire alla pagina di login il token utente crittografato usando l\u2019algoritmo 3-DES/ECB/NoPadding. Il token sar\u00e0 perci\u00f2 prima firmato, poi crittografato ed infine convertito in base64 e inviato in POST alla pagina di login. L\u2019utilizzo della cifratura del token \u00e8 necessario qualora si utilizzi una pagina di login non protetta da connessione sicura https. Qualora la connessione sia in https \u00e8 sufficiente la firma del token per garantire un livello sicurezza elevato.</li> <li>urlRichiesta: Questo valore va impostato solo nel caso si scelga di non inviare il parametro ReturnUrl durante la chiamata alla servlet di autenticazione per mezzo della pagina di login. In tal caso la servlet restituir\u00e0 il token utente in POST alla pagina specificata in urlRichiesta, altrimenti sar\u00e0 restituito alla pagina specificata in ReturnUrl.</li> <li>urlIndex: pagina iniziale a cui reindirizzare in caso di errore. Se non viene specificata viene mostrato l'errore nella pagina in cui si presenta.</li> </ul> <p>c) Parametri relativi all'IdP Cohesion Per abilitare il funzionamento in modalit\u00e0 SAML2.0 \u00e8 sufficiente cambiare i valori di urlCheck, wsSso e additionalData nel seguente modo:</p> <ul> <li>urlCheck: https://cohesion2.regione.marche.it/SPManager/WAYF.aspx</li> <li>wsSso: https://cohesion2.regione.marche.it/SPManager/wsCheckSessionSPM.asmx</li> <li>additionalData: http://yourhost/YOURSITE/Logout.aspx</li> </ul> <p>Deve contenere obbligatoriamente il percorso completo della propria pagina di logout affinch\u00e9 il logout SAML funzioni correttamente. Pu\u00f2 contenere altri due parametri opzionali: i livelli di autenticazione da mostrare (parametro AuthRestriction) e un flag per mostrare solo i meccanismi di accesso federato SPID, CIEID, CNS e l'accesso tramite dominio. I vari parametri vanno separati da punto e virgola \";\".</p> <p>Per approfondimenti in merito alla configurazione dei parametri addizionali, \u00e8 possibile far riferimento alla pagina Parametri della Richiesta di Autenticazione. </p> <p>Opzionale</p> <p>Dopo l'URL di logout \u00e8 possibile inserire la stringa eidas=1. L'inserimento di questa stringa abilita la login eIDAS nel sistema di autenticazione SAML 2.0 di Cohesion. Questa opzione \u00e8 compatibile con tutte le altre fin qui indicate. </p> <p>Es. <code>AuthRestriction=2,1;http://host/YOURSITE/Logout.aspx;UType=c;eidas=1</code></p> <p>Affinch\u00e8 in modalit\u00e0 SAML2.0 funzioni il single logout \u00e8 poi necessario che la propria pagina di logout richiami la servlet di logout passando il parametro ReturnUrl valorizzato come segue:</p> <p><code>\u2026./Logout? ReturnUrl=https%3A%2F%2Fcohesion2.regione.marche.it%2FSPManager%2FLogout.aspx</code></p> <p>E' possibile forzare l'entityID utilizzato dall'utente, impostando il seguente parametro nel query string    entityID=:idp <p>Esempio (Sviluppo):</p> <pre><code>https://cohesion2sviluppo.regione.marche.it/SPManager/WAYF.aspx?entityID=cohesion.regione.marche.it:idp\n</code></pre> <p>Esempio (Produzione):</p> <pre><code>https://cohesion2.regione.marche.it/SPManager/WAYF.aspx?entityID=cohesion2.regione.marche.it:idp\n</code></pre>"},{"location":"Integrazione-Servlet-Java/#parametro-id_sito","title":"Parametro id_sito","text":"<p>In caso per l'integrazione sia necessario impostare un IDSito col valore fornito da Regione Marche in fase di abilitazione all'uso di cohesion, il valore va sostituito nella classe contenuta nel WAR Java</p> <pre><code>WEB-INF\\classes\\it\\unicam\\cs\\cohesion\\servlet\\AuthServlet.java\n</code></pre> <p>riga 34 [private String idsito = \"TEST\";]</p> <p>e nella classe</p> <pre><code>WEB-INF\\classes\\it\\unicam\\cs\\cohesion\\servlet\\LogoutServlet.java\n</code></pre> <p>riga 22 [private String idsito = \"TEST\";]</p>"},{"location":"Integrazione-Servlet-Java/#rinnovo-asserzione-saml","title":"Rinnovo asserzione SAML","text":"<p>Una volta autenticati, la sessione per il Single Sign On sar\u00e0 valida per 60 minuti. Nella modalit\u00e0 SAML questo tempo sar\u00e0 anche specificato nella risposta SAML ritornata dall\u2019IdP. Entro tale tempo sar\u00e0 possibile accedere a qualunque sito protetto da Cohesion senza che appaia la maschera di autenticazione. Il Service Provider in tal caso otterr\u00e0 un nuovo token (contenente anche una nuova asserzione SAML in caso di modalit\u00e0 SAML) ed un rinnovamento del cookie di sessione per altri 60 minuti.</p> <p>Qualora si volesse rinnovare la sessione dal proprio SP sar\u00e0 perci\u00f2 necessario cancellare il cookie di sessione del proprio sito entro i 60 minuti (es. a 50 minuti) e redirigere l\u2019utente ad una propria pagina privata che richiede l\u2019autenticazione per l\u2019accesso. A questo punto il SP rigirer\u00e0 l\u2019utente all\u2019IdP Cohesion che, vedendo ancora valida la sessione, aggiorner\u00e0 il cookie di sessione di altri 60 minuti e ritorner\u00e0 un nuovo token o una nuova asserzione SAML valida altri 60 minuti senza mostrare l\u2019interfaccia di autenticazione.</p>"},{"location":"Linee-guida-Livello-di-autenticazione/","title":"\ud83c\udfdb\ufe0f Linea Guida per l'Assegnazione del Livello di Accesso (LoA) ai Servizi Digitali","text":""},{"location":"Linee-guida-Livello-di-autenticazione/#1-riferimenti-normativi","title":"\u2696\ufe0f 1. Riferimenti normativi","text":"<ul> <li>Regolamento (UE) n. 910/2014 (eIDAS): definisce i livelli di garanzia delle identit\u00e0 elettroniche (basso, sostanziale, alto).</li> <li>D.Lgs. 82/2005 (CAD), artt. 64, 64-bis, 65.</li> <li>Linee guida AgID su SPID, CIE e CNS.</li> <li>Principio di proporzionalit\u00e0 (CAD e art. 5 GDPR): il livello di autenticazione richiesto deve essere commisurato alla sensibilit\u00e0 del servizio.</li> </ul>"},{"location":"Linee-guida-Livello-di-autenticazione/#2-definizione-dei-livelli-di-accesso","title":"\ud83e\udde9 2. Definizione dei Livelli di Accesso","text":"LoA Descrizione Esempi di credenziali accettate Basso Identit\u00e0 con verifica minima, spesso senza garanzia sulla persona fisica SPID Livello 1, social login, registrazione via email Sostanziale Identit\u00e0 verificata con almeno due fattori e rilascio da soggetto accreditato SPID Livello 2, CIE con app/OTP, CNS con PIN Alto Identit\u00e0 digitale con alto grado di certezza, uso di certificati o dispositivi hardware SPID Livello 3, CIE con lettore + PIN, CNS con autenticazione forte"},{"location":"Linee-guida-Livello-di-autenticazione/#3-criteri-per-lassegnazione-del-loa","title":"\ud83e\uddee 3. Criteri per l\u2019assegnazione del LoA","text":"Criterio LoA basso LoA sostanziale LoA alto Accesso a dati personali non sensibili \u2705 \u2705 \u2705 Accesso a dati sensibili / sanitari / patrimoniali \u274c \u2705 \u2705 Servizio informativo senza valore legale \u2705 \u274c \u274c Servizio che produce effetti giuridici o dichiarazioni \u274c \u2705 \u2705 Servizio con firma elettronica avanzata o qualificata \u274c \u274c \u2705 Servizio con valore probatorio o patrimoniale rilevante \u274c \u2705 \u2705 Servizio transfrontaliero (eIDAS) \u274c \u2705 \u2705 (se richiesto)"},{"location":"Linee-guida-Livello-di-autenticazione/#4-esempi-di-servizi-regione-marche-per-ciascun-loa","title":"\ud83d\uddc2\ufe0f 4. Esempi di Servizi Regione Marche per ciascun LoA","text":"Servizio LoA richiesto Note Consultazione bandi pubblici Basso Nessun dato personale richiesto Prenotazione evento informativo Basso Autenticazione opzionale Consultazione fascicolo sanitario elettronico (FSE) Sostanziale Dati sensibili Richiesta di contributo economico (es. bandi PSR) Sostanziale Rilevanza giuridico-economica Firma digitale su istanza SUAP o SCIA Sostanziale Comporta effetti legali e responsabilit\u00e0 Accesso al portale della formazione professionale Sostanziale Dati personali + attivit\u00e0 tracciate Invio segnalazione non firmata (es. decoro urbano) Basso Nessuna responsabilit\u00e0 formale dell\u2019utente"},{"location":"Linee-guida-Livello-di-autenticazione/#5-obblighi-per-le-strutture-regionali","title":"\ud83d\udee1\ufe0f 5. Obblighi per le strutture regionali","text":"<ul> <li>Ogni servizio digitale deve dichiarare il livello di autenticazione richiesto nella richiesta di federazione a Cohesion Id.</li> <li>I sistemi esposti ai cittadini devono accettare SPID, CIE e CNS come previsto dall\u2019art. 64 CAD.</li> <li>\u00c8 vietato imporre un livello di accesso superiore a quello necessario.</li> </ul>"},{"location":"Linee-guida-Livello-di-autenticazione/#faq","title":"FAQ","text":""},{"location":"Linee-guida-Livello-di-autenticazione/#domanda","title":"\u2753 Domanda:","text":"<p>Un sito della Pubblica Amministrazione, esposto solo su rete interna e utilizzato esclusivamente da dipendenti, pu\u00f2 adottare un livello di autenticazione \"basso\"?</p>"},{"location":"Linee-guida-Livello-di-autenticazione/#risposta","title":"\u274c Risposta:","text":"<p>No, in linea generale un sito della Pubblica Amministrazione, anche se accessibile solo da rete interna e riservato ai soli dipendenti, non pu\u00f2 adottare un livello di autenticazione \"basso\" se sussiste almeno una delle seguenti condizioni:</p> <ul> <li>tratta dati personali o informazioni riservate;</li> <li>consente la gestione o visualizzazione di contenuti amministrativi, come atti, determinazioni, provvedimenti o documenti protocollati;</li> <li>abilita operazioni rilevanti dal punto di vista amministrativo o organizzativo.</li> </ul> <p>L\u2019adozione di un livello di autenticazione basso \u00e8 ammessa solo se sussistono contemporaneamente tutte le seguenti condizioni:</p> <ul> <li>Il sito non tratta dati personali, n\u00e9 atti amministrativi o documenti protocollati;</li> <li>Le funzionalit\u00e0 offerte hanno un basso impatto sul rischio di sicurezza, limitandosi ad attivit\u00e0 informative o consultive non critiche;</li> <li>L\u2019accesso \u00e8 protetto a livello infrastrutturale, ad esempio tramite rete isolata, VPN o autenticazione a dominio;</li> <li>\u00c8 garantito il rispetto dei principi di proporzionalit\u00e0, minimizzazione e necessit\u00e0, ai sensi del Regolamento (UE) 2016/679 \u2013 GDPR.</li> </ul> <p>In assenza di queste condizioni, il livello minimo di autenticazione richiesto deve essere almeno \"significativo\", come previsto dalla normativa.</p>"},{"location":"Linee-guida-Livello-di-autenticazione/#domanda_1","title":"\u2753 Domanda:","text":"<p>Gli utenti del servizio PA hanno sempre utilizzato nome utente e password di Cohesion (livello \"basso\") per accedere. Innalzando il livello a \"significativo\" (Codice Fiscale, Password e PIN), molti di loro non riusciranno pi\u00f9 ad accedere. Come \u00e8 possibile fare?</p>"},{"location":"Linee-guida-Livello-di-autenticazione/#risposta_1","title":"\u2705 Risposta:","text":"<p>Con l\u2019innalzamento del livello di autenticazione da \"basso\" a \"significativo\", l\u2019accesso al servizio richiede un meccanismo di autenticazione pi\u00f9 robusto, conforme al Regolamento eIDAS e alle Linee guida AgID sull\u2019identit\u00e0 digitale.</p> <p>Per garantire la continuit\u00e0 del servizio:</p> <ul> <li>Gli utenti esterni alla Pubblica Amministrazione (es. cittadini, imprese, professionisti) dovranno utilizzare un\u2019identit\u00e0 digitale qualificata, scegliendo tra:</li> <li>SPID (Sistema Pubblico di Identit\u00e0 Digitale) </li> <li>CIE (Carta d\u2019Identit\u00e0 Elettronica) </li> <li>CNS (Carta Nazionale dei Servizi) </li> </ul> <p>Questi strumenti garantiscono un livello di autenticazione \"significativo\" o \"elevato\", pienamente compatibile con il nuovo requisito del servizio.</p> <ul> <li>Per gli utenti interni alla PA (dipendenti), in alternativa a SPID/CIE/CNS, \u00e8 possibile rilasciare un PIN Cohesion, che consente l\u2019accesso al sistema in modalit\u00e0 \"significativa\" attraverso il circuito di autenticazione federato Cohesion, integrando:</li> <li>Codice Fiscale</li> <li>Password</li> <li>PIN personale</li> </ul> <p>In questo modo si garantisce il rispetto dei requisiti normativi senza compromettere l\u2019accessibilit\u00e0 al servizio da parte degli utenti autorizzati.</p>"},{"location":"Linee-guida-Livello-di-autenticazione/#domanda_2","title":"\u2753 Domanda:","text":"<p>C\u2019\u00e8 un livello minimo di autenticazione?</p>"},{"location":"Linee-guida-Livello-di-autenticazione/#risposta_2","title":"\u2705 Risposta:","text":"<p>S\u00ec, secondo le normative in vigore, il livello minimo di autenticazione richiesto \u00e8 \"significativo\" (livello 2).</p> <p>Tuttavia, se il servizio non richiede una protezione elevata e soddisfa determinati requisiti (ad esempio, non trattando dati sensibili o riservati), pu\u00f2 essere richiesto un livello di autenticazione inferiore. In tal caso, \u00e8 necessario giustificare questa scelta in fase di integrazione o, successivamente, attraverso una richiesta formale di modifica del livello di autenticazione.</p>"},{"location":"Linee-guida-Livello-di-autenticazione/#domanda_3","title":"\u2753 Domanda:","text":"<p>Un sito che gestisco \u00e8 gi\u00e0 integrato in Cohesion, che di default applica il livello \"significativo\" di autenticazione. Tuttavia, il mio sito ha caratteristiche che giustificherebbero un accesso con livello \"basso\". A chi posso comunicarlo?</p>"},{"location":"Linee-guida-Livello-di-autenticazione/#risposta_3","title":"\u2705 Risposta:","text":"<p>Nel sistema Cohesion, il livello di autenticazione \"significativo\" viene applicato come impostazione predefinita per garantire il rispetto delle Linee guida AgID. Tuttavia, se il sito non tratta dati personali, atti amministrativi o contenuti sensibili e soddisfa i requisiti per un livello di autenticazione \"basso\", \u00e8 possibile richiedere l\u2019adeguamento.</p> <p>La comunicazione del livello minimo di autenticazione avviene in due modalit\u00e0:</p> <ul> <li> <p>In fase di federazione iniziale:   \u00c8 necessario compilare il modulo di richiesta federazione, specificando il livello minimo desiderato (il livello basso deve essere opportunamente giustificato), disponibile al seguente link:   \ud83d\udd17 Modulo federazione Cohesion \u2013 Avvio</p> </li> <li> <p>In caso di variazione successiva (es. abbassamento del livello da \"significativo\" a \"basso\"):   Occorre compilare il modulo di richiesta di modifica del livello di autenticazione, disponibile qui:   \ud83d\udd17 Modulo richiesta modifica livello di accesso</p> </li> </ul> <p>La richiesta sar\u00e0 valutata dal team tecnico e, se conforme ai criteri di sicurezza e proporzionalit\u00e0 previsti dalla normativa vigente, il livello potr\u00e0 essere aggiornato di conseguenza nel sistema Cohesion.</p>"},{"location":"Parametri-della-Richiesta-di-Autenticazione/","title":"Parametri della Richiesta di Autenticazione","text":"<p>In questa sezione definiamo in dettaglio i parametri di autenticazione presenti nel tag <code>stilesheet</code> della Richiesta di Autenticazione effettuata da Cohesion.</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-16\"?&gt;\n&lt;dsAuth xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxmlns=\"http://tempuri.org/Auth.xsd\"\n&lt;auth&gt;\n&lt;user /&gt;\n&lt;id_sa /&gt;\n&lt;id_sito&gt;SITE_ID&lt;/id_sito&gt;\n&lt;esito_auth_sa /&gt;\n&lt;id_sessione_sa /&gt;\n&lt;id_sessione_aspnet_sa /&gt;\n&lt;url_validate&gt;\nhttps://cohesion2.regione.marche.it/TestCohesion/ValidateFE.aspx?ReturnUrl=%2ftestcohesion%2fprivato%2fpagina_protetta.aspx&lt;/url_validate&gt;\n&lt;url_richiesta&gt;\nhttps://cohesion2.regione.marche.it:443/testcohesion/privato/pagina_protetta.aspx&lt;/url_richiesta&gt;\n&lt;esito_auth_sso /&gt;\n&lt;id_sessione_sso /&gt;\n&lt;id_sessione_aspnet_sso /&gt;\n&lt;stilesheet&gt;AuthRestriction=3,2,1,0;\nhttps://cohesion2.regione.marche.it/testcohesion/Index.aspx;UType=d;purpose=PG|PF|LP;aggregato=1;eidas=3;SpidMode=OIDC;CieMode=OIDC;IPA=c_000;SSO=1&lt;/stilesheet&gt;\n&lt;/auth&gt;\n&lt;/dsAuth&gt;\n</code></pre>"},{"location":"Parametri-della-Richiesta-di-Autenticazione/#authrestriction","title":"<code>AuthRestriction</code>","text":"<p>Il parametro <code>AuthRestriction</code> stabilisce il livello di autenticazione minimo richiesto associandolo a un valore numerico (0,1,2,3). Nello specifico:</p> <p>0= Accesso solo con password - SPID Livello 1</p> <p>1= Accesso con password e PIN o token OTP - SPID Livello 2</p> <p>2= Accesso con smartcard - SPID Livello 3</p> <p>3= Accesso con Dominio Active Directory REGIONEMARCHE</p> <p>Ad esempio, impostando il parametro come <code>AuthRestriction=3,2,1</code> stabiliamo che l'accesso sar\u00e0 consentito ad utenze che dispongono di credenziali SPID di Livello 2 e 3, nonch\u00e9 tramite Dominio, ma non sar\u00e0 possibile utilizzare credenziali SPID di primo livello.</p> <p> ATTENZIONE</p> <p>L'applicazione integrante \u00e8 tenuta a verificare il livello di accesso indicato nel token ricevuto al termine della procedura di login, al fine di garantire che sia conforme a quanto previsto dal livello di autenticazione configurato.</p>"},{"location":"Parametri-della-Richiesta-di-Autenticazione/#url-di-reindirizzamento","title":"URL di reindirizzamento","text":"<p>L'URL al quale l'utente sar\u00e0 reindirizzato dopo aver effettuato l'autenticazione.</p>"},{"location":"Parametri-della-Richiesta-di-Autenticazione/#utype","title":"<code>UType</code>","text":"<p>Specifica la tipologia di utente che accede tramite Cohesion. Si distinguono 3 differenti tipologie:</p> <p><code>UType=c</code> = Accesso per soli cittadini, l'autenticazione tramite credenziali Cohesion \u00e8 disabilitata</p> <p><code>UType=d</code> = Accesso per soli Dipendenti della PA, viene abilitata l'autenticazione tramite credenziali Cohesion</p> <p><code>UType=cd</code> = Accesso per Dipendenti delle PA e Cittadini, l'autenticazione tramite credenziali Cohesion \u00e8 abilitata (opzione di default)</p> <p>Ad esempio, impostando il parametro come segue <code>UType=c</code> stabiliamo che l'unica tipologia di utenza accettabile \u00e8 il cittadino, disabilitando l'accesso tramite credenziali Cohesion</p>"},{"location":"Parametri-della-Richiesta-di-Autenticazione/#purpose","title":"<code>purpose</code>","text":"<p>Definisce il livello di sicurezza SPID in base alla tipologia (o scopo) dell'utente. Si distinguono in:</p> <p>PF = SPID personale per Persona Fisica, costituisce l'identit\u00e0 di un cittadino che accede ai servizi della PA</p> <p>LP = SPID del Libero Professionista, racchiude i dati i dati della persona fisica ed eventuali attributi che caratterizzano la sua professione.</p> <p>PG = SPID Giuridico, rilasciata ad una persona fisica a cui vengono associati anche i dati della persona giuridica per cui opera.</p> <p>Ad esempio, impostando il parametro come <code>purpose=PG</code> Cohesion consentir\u00e0 l'accesso solamente alle persone dotate di SPID Giuridico.</p> <p>Per la lista completa dei gestori di Identit\u00e0 Digitali che supportano le tipologie PG e LP, si prega di consultare il seguente link: https://www.agid.gov.it/it/piattaforme/spid</p>"},{"location":"Parametri-della-Richiesta-di-Autenticazione/#aggregato","title":"<code>aggregato</code>","text":"<p>Se l'ente \u00e8 federato in modalit\u00e0 aggregata, sar\u00e0 necessario inserire il parametro <code>aggregato=1</code></p> <p>Se non specificato, verr\u00e0 utilizzata la modalit\u00e0 di default diretta</p>"},{"location":"Parametri-della-Richiesta-di-Autenticazione/#eidas","title":"<code>eidas</code>","text":"<p>Abilita il login tramite il nodo italiano eIDAS specificando se, a valle dell'autenticazione, \u00e8 necessaria la verifica del Codice Fiscale:</p> <p><code>eidas=1</code> = Autenticazione eidas abilitata, nessuna verifica del Codice Fiscale.</p> <p><code>eidas=2</code> = Verifica semplice del Codice Fiscale.</p> <p><code>eidas=3</code> = Verifica del Codice Fiscale con supporto fisico.</p> <p>Ad esempio, impostando il parametro come <code>eidas=3</code> sar\u00e0 necessaria la verifica del Codice Fiscale tramite supporto, escludendo i livelli di autenticazione pi\u00f9 bassi.</p>"},{"location":"Parametri-della-Richiesta-di-Autenticazione/#spidmode","title":"<code>SpidMode</code>","text":"<p>Definisce il protocollo di autenticazione che CohesionID deve utilizzare per comunicare con la piattaforma nazionale SPID. </p> <p>Se non specificato, verr\u00e0 utilizzato il protocollo di default SAML. Impostando il parametro come <code>SpidMode=OIDC</code> verr\u00e0 utilizzato il nuovo protocollo OpenID Connect </p>"},{"location":"Parametri-della-Richiesta-di-Autenticazione/#ciemode","title":"<code>CieMode</code>","text":"<p>Definisce il protocollo di autenticazione che CohesionID deve utilizzare per comunicare con la piattaforma nazionale CIE. </p> <p>Se non specificato, verr\u00e0 utilizzato il protocollo di default SAML mentre, impostando il parametro come <code>CieMode=OIDC</code>, verr\u00e0 utilizzato il nuovo protocollo OpenID Connect </p>"},{"location":"Parametri-della-Richiesta-di-Autenticazione/#ipa","title":"<code>IPA</code>","text":"<p>L'IPA \u00e8 l'Indice delle Pubbliche Amministrazioni, univoco ad ogni ente della Pubblica Amministrazione. </p> <p>Specificando questo parametro, CohesionID effettuer\u00e0 la richiesta di autenticazione verso le piattaforme nazionali ed europee per conto dell'ente aggregato specificato.</p>"},{"location":"Parametri-della-Richiesta-di-Autenticazione/#sso","title":"<code>SSO</code>","text":"<p>Il parametro SSO abilita la funzionalit\u00e0 di Single Sign-On, che consente agli utenti di autenticarsi una sola volta ed accedere a pi\u00f9 servizi senza dover inserire nuovamente le credenziali.</p> <p>Se non specificato, il valore di default \u00e8 <code>SSO=0</code>. Impostando il parametro <code>SSO=1</code>, se l'utente ha gi\u00e0 effettuato l'autenticazione di livello almeno pari o superiore a quello richiesto dal servizio di destinazione, potr\u00e0 accedere senza dover ripetere il login. </p>"},{"location":"Per-PA-e-Imprese/","title":"Per PA e Imprese","text":"<p>Il framework di autenticazione Cohesion ID pu\u00f2 essere integrato esclusivamente nei siti della Pubblica Amministrazione. </p> <p>Se il sito \u00e8 pubblicato da o per conto della Regione Marche o dipendi da un Ente che ha sottoscritto la convenzione per l\u2019utilizzo dell\u2019infrastruttura di autenticazione e accesso, consulta la nostra guida Come Integrare Cohesion</p>"},{"location":"Pubbliche-Amministrazioni-e-Imprese/","title":"Come integro CohesionID?","text":""},{"location":"Pubbliche-Amministrazioni-e-Imprese/#richiesta-di-integrazione","title":"Richiesta di Integrazione","text":"<p>Il primo step del processo di Integrazione del Sistema Cohesion nel proprio applicativo \u00e8 la Richiesta di Integrazione.</p> <p>Nel caso in cui il sistema informativo in questione sia pubblicato da o per conto di Regione Marche \u00e8 possibile compilare direttamente la Richiesta di Integrazione al link: Richiesta di Integrazione.  Ricordiamo che Cohesion \u00e8 integrabile esclusivamente nei siti della pubblica amministrazione. </p>"},{"location":"Pubbliche-Amministrazioni-e-Imprese/#livello-di-autenticazione-minimo","title":"Livello di autenticazione minimo","text":"<p>All'interno del modulo di richiesta \u00e8 necesario specificare il livello di accesso minimo necessario per il servizio. Nel caso in cui il sistema di autenticazione riceva una richiesta di autenticazione per il servizio associata a un livello di autenticazione inferiore a quello minimo indicato, Cohesion ignorer\u00e0 il livello di accesso indicato ed esporr\u00e0 il livello minimo.</p>"},{"location":"Pubbliche-Amministrazioni-e-Imprese/#esempio-concreto","title":"Esempio concreto","text":"<p>Ipotesi: nella richiesta di federazione per il sistema <code>serviziopubblico.it</code> \u00e8 stato specificato un livello di accesso minimo \"Significativo\".</p> <p>Una volta che il servizio \u00e8 stato federato, Cohesion riceve una richiesta di autenticazione con livello \"Basso\" (quindi inferiore a \"Significativo\"). In questo caso, Cohesion esporr\u00e0 all\u2019utente una maschera di accesso con livello \"Significativo\", ignorando la richiesta specifica.</p>"},{"location":"Pubbliche-Amministrazioni-e-Imprese/#nota","title":"Nota","text":"<p>Per ogni servizio per cui si richiede un livello minimo \"Basso\", \u00e8 necessario specificare la motivazione di tale scelta nel campo di testo sottostante.</p> <p>Per identificare il livello di autenticazione minimo adeguato si pu\u00f2 fare riferimento a quanto indicato nella documentazione tecnica del servizio: \ud83d\udd17 cohesion.regione.marche.it/CohesionDocs/Linee-guida-Livello-di-autenticazione</p>"},{"location":"Pubbliche-Amministrazioni-e-Imprese/#convenzione-per-lutilizzo-di-cohesion-id","title":"Convenzione per l'utilizzo di Cohesion Id","text":"<p>Nel caso in cui l\u2019Ente responsabile non sia Regione Marche \u00e8 necessario assicurarsi che questi abbia sottoscritto la convenzione per l\u2019utilizzo dell\u2019infrastruttura di autenticazione e accesso della Regione Marche quale Soggetto Aggregatore SPID: https://procedimenti.regione.marche.it/AreaPA/TipologieProcedimento/DettagliTer/13915</p>"},{"location":"Pubbliche-Amministrazioni-e-Imprese/#id-sito","title":"ID Sito","text":"<p>Effettuata la richiesta, i nostri tecnici processeranno i dati inseriti ed invieranno una mail al tecnico indicato con l'ID Sito univoco per la vostra applicazione.</p>"},{"location":"Pubbliche-Amministrazioni-e-Imprese/#integrazione","title":"Integrazione","text":"<p>Completata la richiesta di Integrazione e ottenuto l'ID Sito, sar\u00e0 possibile procedere all'effettiva integrazione nel proprio applicativo. Per supporto nell'integrazione, consulta la documentazione relativa al flusso di autenticazione e i parametri della richiesta di autenticazione. Nel caso si voglia utilizzare una delle integrazioni gi\u00e0 disponibili, consultare la Documentazione Tecnica</p>"},{"location":"Richiesta-Credenziali-Cohesion/","title":"Credenziali Cohesion id","text":"<p>Attenzione</p> <p>A partire dal 1\u00b0 marzo 2021, ai sensi dell\u2019art. 24 del D.L. 76/2020, convertito con modificazioni dalla L. 120/2020 (Decreto Semplificazioni), le credenziali Cohesion id possono essere rilasciate esclusivamente al personale interno della Pubblica Amministrazione.</p> <p>I cittadini non possono pi\u00f9 ottenere nuove credenziali Cohesion ID, ma possono accedere ai servizi digitali tramite:</p> <ul> <li>SPID (Sistema Pubblico di Identit\u00e0 Digitale)  </li> <li>CIE (CieID) \u2013 Carta d\u2019Identit\u00e0 Elettronica  </li> <li>CNS \u2013 Carta Nazionale dei Servizi  </li> </ul>"},{"location":"Richiesta-Credenziali-Cohesion/#richiesta-e-rilascio-delle-credenziali","title":"Richiesta e rilascio delle credenziali","text":"<p>Le credenziali Cohesion id possono essere rilasciate esclusivamente ai dipendenti della Pubblica Amministrazione o a soggetti autorizzati all\u2019interno di enti convenzionati, nei casi previsti dalla normativa vigente.</p> <p>Per effettuare la richiesta, \u00e8 possibile rivolgersi a:</p> <ul> <li> <p>Servizio Cittadinanza Digitale \u2013 Regione Marche   \ud83d\udce7 cittadinanza.digitale@regione.marche.it</p> </li> <li> <p>Ufficio di registrazione del proprio ente di appartenenza (l\u2019elenco degli uffici abilitati \u00e8 attualmente in fase di aggiornamento)</p> </li> </ul>"},{"location":"Richiesta-Credenziali-Cohesion/#gestione-credenziali-cohesion-id","title":"Gestione credenziali Cohesion id","text":""},{"location":"Richiesta-Credenziali-Cohesion/#recupero-password","title":"Recupero password","text":"<p>In caso di smarrimento della password, \u00e8 possibile avviare la procedura di recupero online: \ud83d\udc49 Recupera la password</p> <p>In alternativa, \u00e8 possibile cliccare su My Cohesion, il menu disponibile in alto a destra in ogni pagina di login Cohesion id, e selezionare la voce Reset Password per avviare la procedura.</p>"},{"location":"Richiesta-Credenziali-Cohesion/#cambio-password","title":"Cambio password","text":"<p>Per modificare la propria password, accedere al menu My Cohesion presente in alto a destra in ogni pagina di login e selezionare la voce Cambia Password.</p> <p>Per procedere sar\u00e0 necessario effettuare l\u2019autenticazione.</p>"},{"location":"Richiesta-Credenziali-Cohesion/#pin-dimenticato","title":"PIN dimenticato","text":"<p>In caso di PIN dimenticato, \u00e8 possibile richiederne una copia tramite uno dei seguenti canali:</p> <ul> <li> <p>Telefonando all\u2019Helpdesk:   \u260e\ufe0f 071 8063000, interno 1</p> </li> <li> <p>Scrivendo a:   \ud83d\udce7 cittadinanza.digitale@regione.marche.it</p> </li> <li> <p>Rivolgendosi a un ufficio di registrazione abilitato (lista in aggiornamento)</p> </li> </ul>"},{"location":"Richiesta-Credenziali-Cohesion/#richiesta-del-pin-per-credenziali-gia-esistenti","title":"Richiesta del PIN per credenziali gi\u00e0 esistenti","text":"<p>Gli utenti in possesso delle sole credenziali Codice Fiscale + Password possono richiedere l\u2019aggiunta del PIN, necessario per accedere ai servizi che richiedono un livello di autenticazione significativo, purch\u00e9 rientrino nei casi previsti dalla normativa vigente (vedi riquadro \u201cAttenzione\u201d all\u2019inizio della pagina).</p> <p>La procedura pu\u00f2 essere avviata attraverso uno dei seguenti canali:</p> <ul> <li> <p>Contattando l\u2019Helpdesk:   \u260e\ufe0f 071 8063000, interno 1</p> </li> <li> <p>Scrivendo a:   \ud83d\udce7 cittadinanza.digitale@regione.marche.it</p> </li> <li> <p>Rivolgendosi a un ufficio di registrazione abilitato (lista in aggiornamento)</p> </li> </ul> <p>Per ulteriori informazioni \u00e8 possibile contattare il Servizio Cittadinanza Digitale \u2013 Regione Marche \ud83d\udce7 cittadinanza.digitale@regione.marche.it</p>"},{"location":"Rinnovo-del-Token/","title":"Come rinnovare il Token","text":"<p>Il Token di Cohesion ha validit\u00e0 di 60 minuti. Se si vuole rinnovare il Token \u00e8 necessario che l'utente transiti nuovamente per la pagina di LogIn di Cohesion.  Questa operazione va fatta prima della scadenza del Token.</p> <p>Esempi:</p> <p>1) Integrazione C#:</p> <p>Per rinnovare il token \u00e8 sufficiente reindirizzare l'utente alla propria pagina di login, in modo da eseguire nuovamente il codice</p> <pre><code>CohesionSSO cohesionSSO = new CohesionSSO(Request, Response, Session);\n\ncohesionSSO.ValidateFE();\n</code></pre> <p>2) Integrazione Servlet Java:</p> <p>Per rinnovare il token \u00e8 sufficiente reindirizzare l'utente alla Servlet Java, di norma richiamata dalla pagina di login della applicazione.</p> <p>In entrambi i casi l'utente viene reindirizzato a Cohesion, il sistema verifica che ha gi\u00e0 una sessione valida, genera un nuovo Token valido 60 minuti e reindirizza l'utente all'applicazione.</p> <p>Se si integra con modalit\u00e0 SPManager, per evitare che - al nuovo passaggio su Cohesion - venga riproposta all'utente la schermata di scelta del provider, impostare il parametro entityID passandolo alla pagina WAYF SAML.</p> <p>Ad esempio:</p> <ul> <li>Cohesion Sviluppo</li> </ul> <pre><code>https://cohesion2sviluppo.regione.marche.it/SPManager/WAYF.aspx?entityID=cohesion.regione.marche.it:idp\n</code></pre> <ul> <li>Cohesion Produzione</li> </ul> <pre><code>https://cohesion2.regione.marche.it/SPManager/WAYF.aspx?entityID=cohesion2.regione.marche.it:idp\n</code></pre> <p>ovvero passando il parametro entityID valorizzato con l'id dell'entit\u00e0 SAML a cui si vuole redirigere automaticamente (che nel caso di cohesion \u00e8 cohesion.regione.marche.it:idp).</p>"},{"location":"Tabella-Uffici/","title":"Tabella Uffici","text":""},{"location":"Tabella-Uffici/#uffici-abilitati-al-rilascio-credenziali-cohesion-id","title":"Uffici abilitati al rilascio credenziali Cohesion ID","text":"Ente Indirizzo Citt\u00e0 Telefono Assemblea Legislativa delle Marche Piazza Cavour, 23 Ancona 071 2298321 AST Ancona \u2013 SIA \u2014 Ancona 071 8705641 AST Macerata \u2013 Direzione Amministrativa \u2014 Macerata 0733 2572628 AST Macerata \u2013 SIA \u2014 Macerata 0733 2572723 AST Pesaro Urbino \u2013 SIA \u2014 Pesaro 0722 301369 AST Pesaro Urbino \u2013 URP \u2014 Pesaro 335 1450324 ERDIS \u2013 Ente Regionale per il Diritto allo Studio Via Tiziano, 44 Ancona \u2014 INRCA \u2013 Istituto Nazionale Riposo e Cura Anziani Via Santa Margherita, 5 Ancona 071 8004761 Regione Marche \u2013 Call Center \u2014 \u2014 071 8066800 (scelta 3) Regione Marche \u2013 Protezione Civile Via Gentile da Fabriano, 3 Ancona \u2014 Regione Marche \u2013 Servizio Informatica Via Gentile da Fabriano, 3 Ancona 071 78063720 Regione Marche \u2013 Servizio Risorse Umane Via Tiziano, 44 Ancona \u2014"},{"location":"Tipologie-e-livelli-di-accesso-disponibili-in-CohesionID/","title":"Tipologie e livelli di accesso disponibili in CohesionID","text":"SSO Livello eIDAS tipo_autenticazione issuer Assertiion/Issuer AuthnContextClassRef SPID L1 LoA2 PW provider, es: https://posteid.poste.it/ Uguale al precedente https://www.spid.gov.it/SpidL1 SPID L2 LoA3 PIN provider, es: https://posteid.poste.it/ Uguale al precedente https://www.spid.gov.it/SpidL2 CIE L1 LoA2 PW https://idserver.servizicie.interno.gov.it/idp/profile/SAML2/POST/SSO Uguale al precedente https://www.spid.gov.it/SpidL1 CIE L2 LoA3 PIN https://idserver.servizicie.interno.gov.it/idp/profile/SAML2/POST/SSO Uguale al precedente https://www.spid.gov.it/SpidL2 CIE L3 LoA4 CF https://idserver.servizicie.interno.gov.it/idp/profile/SAML2/POST/SSO Uguale al precedente https://www.spid.gov.it/SpidL3 cf+psw L1 LoA2 PW cohesion2.regione.marche.it:idp Uguale al precedente urn:oasis:names:tc:SAML:2.0:ac:classes:Password cf+psw+pin L2 LoA3 PIN cohesion2.regione.marche.it:idp Uguale al precedente urn:oasis:names:tc:SAML:2.0:ac:classes:Smartcard cf+psw+otp L2 LoA3 PIN cohesion2.regione.marche.it:idp Uguale al precedente urn:oasis:names:tc:SAML:2.0:ac:classes:Smartcard DOMINIO L1 LoA2 DRM cohesion2.regione.marche.it:idp Uguale al precedente urn:oasis:names:tc:SAML:2.0:ac:classes:Kerberos CNS L2 LoA3 CF cohesion2.regione.marche.it:sp Uguale al precedente urn:oasis:names:tc:SAML:2.0:ac:classes:SmartcardPKI eIDAS L1/2/3 LoA2/3/4 CF https://sp-proxy.pre.eid.gov.it/spproxy/idpit Uguale al precedente https://www.spid.gov.it/SpidL1-2-3"},{"location":"eIDAS/","title":"eIDAS","text":""},{"location":"eIDAS/#introduzione","title":"Introduzione","text":"<p>Il regolamento (UE) n. 910/2014, noto come eIDAS (electronic IDentification, Authentication and trust Services), stabilisce le regole per l\u2019identificazione elettronica e i servizi fiduciari per le transazioni elettroniche nel mercato unico europeo. L\u2019obiettivo \u00e8 garantire l\u2019interoperabilit\u00e0 dei sistemi nazionali di identificazione elettronica, permettendo a cittadini e imprese di accedere ai servizi online pubblici e privati in tutta l\u2019UE con credenziali sicure e riconosciute.</p>"},{"location":"eIDAS/#livelli-di-autenticazione-eidas","title":"Livelli di autenticazione eIDAS","text":"<p>Il regolamento definisce tre livelli di garanzia:</p> <ul> <li> <p>eIDAS 1 \u2013 Basso   Identificazione tramite credenziali semplici (es. username e password).   Garantisce un livello base di affidabilit\u00e0.</p> </li> <li> <p>eIDAS 2 \u2013 Sostanziale   Identificazione tramite autenticazione a pi\u00f9 fattori (es. password + OTP, PIN o strumenti equivalenti).   Offre maggiore sicurezza contro accessi non autorizzati.</p> </li> <li> <p>eIDAS 3 \u2013 Elevato   Identificazione con dispositivi di sicurezza avanzati (es. smartcard, token crittografici, dispositivi PKI).   Assicura il massimo livello di protezione.</p> </li> </ul> <p>La scelta del livello minimo richiesto per l\u2019accesso ai servizi \u00e8 a carico dell\u2019ente erogatore e viene impostata tra i parametri della richiesta di autenticazione. Se l\u2019utente presenta un livello inferiore rispetto a quello richiesto, l\u2019accesso viene negato.</p>"},{"location":"eIDAS/#eidas-e-cohesionid","title":"eIDAS e CohesionID","text":"<p>All\u2019interno della piattaforma CohesionID, l\u2019uso del parametro <code>eidas</code> consente di abilitare o meno l\u2019autenticazione tramite nodo eIDAS, definendo anche le modalit\u00e0 di gestione del codice fiscale:</p> <ul> <li><code>eidas=1</code> \u2192 login eIDAS abilitato, senza verifica del Codice Fiscale;  </li> <li><code>eidas=2</code> \u2192 login eIDAS abilitato con verifica semplice del Codice Fiscale;  </li> <li><code>eidas=3</code> \u2192 login eIDAS abilitato con verifica forte del Codice Fiscale.</li> </ul> <p>In generale, per gli utenti esteri autenticati tramite nodo eIDAS, il Codice Fiscale non \u00e8 previsto come attributo. Il sistema trasmette sempre un identificativo univoco europeo (<code>personIdentifier</code>) e, se disponibili, i dati anagrafici di base:</p> <ul> <li>nome  </li> <li>cognome  </li> <li>data di nascita  </li> </ul> <p>Queste informazioni garantiscono la corretta identificazione transfrontaliera senza imporre l\u2019obbligo del codice fiscale, previsto solo in Italia.</p>"},{"location":"eIDAS/#relazione-con-i-livelli-di-accesso","title":"Relazione con i livelli di accesso","text":"<p>I livelli eIDAS corrispondono ai Level of Assurance (LoA) riconosciuti anche da SPID e CIE. In CohesionID, un servizio pu\u00f2 quindi richiedere:</p> <ul> <li>LoA2 / eIDAS 1 \u2192 autenticazione base (password o CIE L1);  </li> <li>LoA3 / eIDAS 2 \u2192 autenticazione pi\u00f9 forte (SPID L2, CIE L2, OTP, smartcard);  </li> <li>LoA4 / eIDAS 3 \u2192 autenticazione con dispositivi crittografici o certificati (CIE L3, CNS, token PKI).</li> </ul> <p>Grazie a questa interoperabilit\u00e0, CohesionID permette di integrare utenze italiane e transfrontaliere, applicando regole di sicurezza omogenee e conformi al regolamento europeo.</p>"}]}